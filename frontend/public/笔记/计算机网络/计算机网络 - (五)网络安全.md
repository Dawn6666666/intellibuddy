# 计算机网络 - (五)网络安全

理解网络安全机制。

---


### 5.1 加密算法

```python
from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes
import base64

def aes_encrypt(plaintext, key):
    """AES加密"""
    cipher = AES.new(key, AES.MODE_EAX)
    ciphertext, tag = cipher.encrypt_and_digest(plaintext.encode())
    return base64.b64encode(cipher.nonce + tag + ciphertext).decode()

def aes_decrypt(ciphertext, key):
    """AES解密"""
    raw = base64.b64decode(ciphertext)
    nonce, tag, ciphertext = raw[:16], raw[16:32], raw[32:]
    cipher = AES.new(key, AES.MODE_EAX, nonce=nonce)
    plaintext = cipher.decrypt_and_verify(ciphertext, tag)
    return plaintext.decode()

# 使用
key = get_random_bytes(16)
encrypted = aes_encrypt("Hello, World!", key)
print(f"加密: {encrypted}")
decrypted = aes_decrypt(encrypted, key)
print(f"解密: {decrypted}")
```

### 5.2 HTTPS（SSL/TLS）

**握手过程：**

1. Client Hello（支持的加密套件）
2. Server Hello（选择的加密套件 + 证书）
3. 密钥交换
4. 加密通信

---

**本章完**
