# 大学物理 - (四)光学

学习几何光学和波动光学。

---

## 4. 光学

### 4.1 几何光学

#### 反射定律

$$
\theta_i = \theta_r
$$

#### 折射定律（斯涅尔定律）

$$
n_1 \sin \theta_1 = n_2 \sin \theta_2
$$

**光线追踪应用**：

```python
def refract(incident, normal, n1, n2):
    """
    计算折射光线
    incident: 入射方向（单位向量）
    normal: 法线方向
    n1, n2: 折射率
    """
    eta = n1 / n2
    cos_i = -np.dot(incident, normal)
    sin_t2 = eta**2 * (1 - cos_i**2)
    
    if sin_t2 > 1:  # 全反射
        return None
    
    cos_t = np.sqrt(1 - sin_t2)
    refracted = eta * incident + (eta * cos_i - cos_t) * normal
    return refracted / np.linalg.norm(refracted)

# 示例：从空气进入玻璃
incident = np.array([1, -1, 0]) / np.sqrt(2)
normal = np.array([0, 1, 0])
refracted = refract(incident, normal, n1=1.0, n2=1.5)
print(f"折射光线: {refracted}")
```

### 4.2 波动光学

#### 光的干涉

**双缝干涉**：

亮纹条件：

$$
\delta = d\sin\theta = k\lambda \quad (k = 0, \pm 1, \pm 2, ...)
$$

暗纹条件：

$$
\delta = (k + \frac{1}{2})\lambda
$$

条纹间距：

$$
\Delta x = \frac{L\lambda}{d}
$$

#### 光的衍射

**单缝衍射**：

暗纹条件：

$$
a\sin\theta = k\lambda \quad (k = \pm 1, \pm 2, ...)
$$

### 4.3 图形学中的光照模型

**Phong光照模型**：

$$
I = I_a + I_d + I_s
$$

- 环境光：$I_a = k_a I_{\text{ambient}}$
- 漫反射：$I_d = k_d (\vec{L} \cdot \vec{N}) I_{\text{light}}$
- 镜面反射：$I_s = k_s (\vec{R} \cdot \vec{V})^n I_{\text{light}}$

```python
def phong_lighting(L, N, V, ka, kd, ks, n, I_ambient, I_light):
    """
    Phong光照计算
    L: 光源方向
    N: 法线
    V: 视线方向
    """
    # 环境光
    ambient = ka * I_ambient
    
    # 漫反射
    diffuse = kd * max(0, np.dot(L, N)) * I_light
    
    # 镜面反射
    R = 2 * np.dot(L, N) * N - L  # 反射光线
    specular = ks * (max(0, np.dot(R, V)) ** n) * I_light
    
    return ambient + diffuse + specular

# 示例
L = np.array([1, 1, 1]) / np.sqrt(3)
N = np.array([0, 1, 0])
V = np.array([0, 1, 0])

intensity = phong_lighting(L, N, V, ka=0.1, kd=0.6, ks=0.3, 
                           n=10, I_ambient=0.2, I_light=1.0)
print(f"光照强度: {intensity:.2f}")
```

---

**本章完**