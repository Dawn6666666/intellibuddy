# 机器学习 - (四)模型评估

掌握模型评估方法。

---

## 4. 模型评估

### 4.1 交叉验证

```python
class KFoldCV:
    def __init__(self, k=5):
        self.k = k
    
    def split(self, X, y):
        """K折分割"""
        n_samples = len(X)
        indices = np.arange(n_samples)
        np.random.shuffle(indices)
        
        fold_size = n_samples // self.k
        folds = []
        
        for i in range(self.k):
            start = i * fold_size
            end = start + fold_size if i < self.k - 1 else n_samples
            
            test_indices = indices[start:end]
            train_indices = np.concatenate([indices[:start], indices[end:]])
            
            folds.append((train_indices, test_indices))
        
        return folds
    
    def cross_validate(self, model, X, y, scoring='accuracy'):
        """交叉验证"""
        scores = []
        folds = self.split(X, y)
        
        for train_idx, test_idx in folds:
            X_train, X_test = X[train_idx], X[test_idx]
            y_train, y_test = y[train_idx], y[test_idx]
            
            # 训练模型
            model.fit(X_train, y_train)
            
            # 预测
            y_pred = model.predict(X_test)
            
            # 计算得分
            if scoring == 'accuracy':
                score = np.mean(y_pred == y_test)
            
            scores.append(score)
        
        return scores

# 示例
cv = KFoldCV(k=5)
dt = DecisionTree()
scores = cv.cross_validate(dt, X, y)
print(f"交叉验证得分: {scores}")
print(f"平均得分: {np.mean(scores):.4f} ± {np.std(scores):.4f}")
```

---

**本章完**
