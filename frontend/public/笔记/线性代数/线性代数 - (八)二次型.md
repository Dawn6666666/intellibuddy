# 线性代数 - (八)二次型

学习二次型的标准化和判定。

---

## 8. 二次型

### 8.1 二次型的定义

**定义**：$n$ 个变量的二次齐次多项式

$$
f(x_1, x_2, ..., x_n) = \sum_{i=1}^{n} \sum_{j=1}^{n} a_{ij} x_i x_j
$$

**矩阵形式**：

$$
f(\mathbf{x}) = \mathbf{x}^T A \mathbf{x}
$$

其中 $A$ 是对称矩阵（$A = A^T$）

**示例：二元二次型**

$$
f(x, y) = x^2 + 4xy + 3y^2
$$

$$
= \begin{bmatrix} x & y \end{bmatrix}
\begin{bmatrix} 1 & 2 \\ 2 & 3 \end{bmatrix}
\begin{bmatrix} x \\ y \end{bmatrix}
$$

### 8.2 二次型的标准化

**目标**：通过变量替换 $\mathbf{x} = P\mathbf{y}$，将二次型化为

$$
f = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \cdots + \lambda_n y_n^2
$$

**方法**：正交对角化（$P$ 为正交矩阵）

```python
def quadratic_form_standard(A):
    """二次型标准化"""
    # 特征值分解
    eigenvalues, eigenvectors = np.linalg.eig(A)
    
    # 标准形
    print(f"标准形: {' + '.join([f'{lam:.2f}*y{i+1}^2' for i, lam in enumerate(eigenvalues)])}")
    
    return eigenvalues, eigenvectors

# 示例
A = np.array([
    [1, 2],
    [2, 3]
], dtype=float)

lambdas, P = quadratic_form_standard(A)
print(f"特征值: {lambdas}")
print(f"变换矩阵:\n{P}")

# 验证
print(f"P^T A P = \n{P.T @ A @ P}")  # 对角矩阵
```

### 8.3 惯性定理与正定性

**惯性定理（Sylvester）**：标准形中
- 正系数个数 = 正特征值个数（正惯性指数 $p$）
- 负系数个数 = 负特征值个数（负惯性指数 $q$）

**分类：**

| 类型 | 特征值 | 判别 |
|------|--------|------|
| 正定 | 全部 $> 0$ | $p = n, q = 0$ |
| 负定 | 全部 $< 0$ | $p = 0, q = n$ |
| 半正定 | $\geq 0$ | $p \geq 1, q = 0$ |
| 不定 | 有正有负 | $p \geq 1, q \geq 1$ |

**应用：多元函数极值**

$$
f(\mathbf{x}) = f(\mathbf{x}_0) + \frac{1}{2}(\mathbf{x} - \mathbf{x}_0)^T H (\mathbf{x} - \mathbf{x}_0) + \cdots
$$

其中 $H$ 是Hessian矩阵，若：
- $H$ 正定 → 极小值
- $H$ 负定 → 极大值
- $H$ 不定 → 鞍点

```python
def classify_critical_point(hessian):
    """分类临界点"""
    eigenvalues = np.linalg.eigvals(hessian)
    
    if np.all(eigenvalues > 0):
        return "极小值（Hessian正定）"
    elif np.all(eigenvalues < 0):
        return "极大值（Hessian负定）"
    else:
        return "鞍点（Hessian不定）"

# 示例：f(x, y) = x^2 + 2y^2 在 (0, 0) 处
H = np.array([[2, 0], [0, 4]])
print(classify_critical_point(H))  # 极小值
```

---

**本章完**
