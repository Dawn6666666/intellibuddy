# 线性代数 - (七)应用案例

线性代数在实际问题中的应用。

---

## 7. 应用案例

### 7.1 图像变换

**2D旋转矩阵**（逆时针旋转 $\theta$）：

$$
R(\theta) = \begin{bmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{bmatrix}
$$

```python
import matplotlib.pyplot as plt

def rotate_image(points, theta):
    """旋转点集"""
    R = np.array([
        [np.cos(theta), -np.sin(theta)],
        [np.sin(theta), np.cos(theta)]
    ])
    return (R @ points.T).T

# 定义正方形
square = np.array([
    [0, 0], [1, 0], [1, 1], [0, 1], [0, 0]
])

# 旋转45度
rotated = rotate_image(square, np.pi / 4)

plt.plot(square[:, 0], square[:, 1], 'b-', label='原图')
plt.plot(rotated[:, 0], rotated[:, 1], 'r-', label='旋转45°')
plt.legend()
plt.axis('equal')
plt.show()
```

### 7.2 主成分分析（PCA）

**目标**：降维，保留最重要的特征。

**步骤：**
1. 数据标准化
2. 计算协方差矩阵
3. 求特征值和特征向量
4. 选择主成分（最大特征值对应的特征向量）

```python
def pca(X, n_components=2):
    """PCA降维"""
    # 中心化
    X_mean = X - np.mean(X, axis=0)
    
    # 协方差矩阵
    cov = np.cov(X_mean.T)
    
    # 特征值分解
    eigenvalues, eigenvectors = np.linalg.eig(cov)
    
    # 排序（降序）
    idx = eigenvalues.argsort()[::-1]
    eigenvectors = eigenvectors[:, idx]
    
    # 投影
    return X_mean @ eigenvectors[:, :n_components]

# 示例：3D降到2D
X = np.random.randn(100, 3)
X_pca = pca(X, 2)

plt.scatter(X_pca[:, 0], X_pca[:, 1])
plt.xlabel('PC1')
plt.ylabel('PC2')
plt.title('PCA降维')
plt.show()
```

### 7.3 SVD图像压缩

**奇异值分解**：

$$
A = U \Sigma V^T
$$

```python
from PIL import Image

# 读取图像
img = Image.open('image.jpg').convert('L')  # 灰度
A = np.array(img, dtype=float)

# SVD分解
U, s, Vt = np.linalg.svd(A, full_matrices=False)

# 保留前k个奇异值
k = 50
A_compressed = U[:, :k] @ np.diag(s[:k]) @ Vt[:k, :]

# 显示
fig, axes = plt.subplots(1, 2)
axes[0].imshow(A, cmap='gray')
axes[0].set_title('原图')
axes[1].imshow(A_compressed, cmap='gray')
axes[1].set_title(f'压缩(k={k})')
plt.show()

# 压缩率
original_size = A.shape[0] * A.shape[1]
compressed_size = k * (A.shape[0] + A.shape[1] + 1)
print(f"压缩率: {compressed_size / original_size:.2%}")
```

---

**本章完**
