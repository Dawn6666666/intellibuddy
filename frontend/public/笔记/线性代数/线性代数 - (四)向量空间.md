# 线性代数 - (四)向量空间

理解向量空间的概念和性质。

---

## 4. 向量空间

### 4.1 向量的基本概念

**向量**：$n$ 个数组成的有序数组。

$$
\mathbf{v} = \begin{bmatrix} v_1 \\ v_2 \\ \vdots \\ v_n \end{bmatrix}
$$

**向量运算：**

$$
\mathbf{u} + \mathbf{v} = \begin{bmatrix} u_1 + v_1 \\ u_2 + v_2 \\ \vdots \\ u_n + v_n \end{bmatrix}
$$

$$
k\mathbf{v} = \begin{bmatrix} kv_1 \\ kv_2 \\ \vdots \\ kv_n \end{bmatrix}
$$

### 4.2 线性相关与线性无关

**定义**：向量组 $\mathbf{v}_1, \mathbf{v}_2, ..., \mathbf{v}_k$ 线性相关，若存在不全为零的 $c_1, c_2, ..., c_k$ 使得

$$
c_1 \mathbf{v}_1 + c_2 \mathbf{v}_2 + \cdots + c_k \mathbf{v}_k = \mathbf{0}
$$

否则称为线性无关。

**判别方法：**

$$
\text{rank}(\mathbf{v}_1, \mathbf{v}_2, ..., \mathbf{v}_k) < k \Rightarrow \text{线性相关}
$$

**示例：**

$$
\mathbf{v}_1 = \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}, \quad \mathbf{v}_2 = \begin{bmatrix} 2 \\ 4 \\ 6 \end{bmatrix}
$$

$\mathbf{v}_2 = 2\mathbf{v}_1$，线性相关。

### 4.3 基与维数

**基**：向量空间的极大线性无关组。

**维数**：基向量的个数。

**示例：**$\mathbb{R}^3$ 的标准基：

$$
\mathbf{e}_1 = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \quad \mathbf{e}_2 = \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}, \quad \mathbf{e}_3 = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}
$$

任意向量可表示为：

$$
\mathbf{v} = v_1 \mathbf{e}_1 + v_2 \mathbf{e}_2 + v_3 \mathbf{e}_3
$$

### 4.4 子空间

**定义**：向量空间的非空子集，封闭于加法和数乘

**常见子空间：**

1. **列空间** $C(A)$：$A$ 的列向量张成的空间
2. **零空间** $N(A)$：$Ax = 0$ 的解空间
3. **行空间** $R(A)$：$A^T$ 的列空间
4. **左零空间** $N(A^T)$：$A^T y = 0$ 的解空间

**四个基本子空间的关系：**

$$
\dim(C(A)) + \dim(N(A^T)) = m
$$

$$
\dim(R(A)) + \dim(N(A)) = n
$$

**Python实现：**

```python
def四个基本子空间(A):
    """计算矩阵的四个基本子空间"""
    m, n = A.shape
    
    # 列空间（通过SVD）
    U, s, Vt = np.linalg.svd(A, full_matrices=True)
    rank = np.sum(s > 1e-10)
    col_space = U[:, :rank]
    
    # 零空间
    null_space = Vt[rank:].T
    
    # 行空间
    row_space = Vt[:rank].T
    
    # 左零空间
    left_null_space = U[:, rank:]
    
    print(f"列空间维数: {col_space.shape[1]}")
    print(f"零空间维数: {null_space.shape[1]}")
    print(f"行空间维数: {row_space.shape[1]}")
    print(f"左零空间维数: {left_null_space.shape[1]}")
    
    return col_space, null_space, row_space, left_null_space

# 示例
A = np.array([
    [1, 2, 3],
    [2, 4, 6]
], dtype=float)

col, null, row, left_null = 四个基本子空间(A)
```

### 4.5 基变换

**基变换矩阵**：从基 $B_1$ 到基 $B_2$ 的变换

$$
[\mathbf{v}]_{B_2} = P_{B_1 \to B_2} [\mathbf{v}]_{B_1}
$$

**示例：$\mathbb{R}^2$ 中的基变换**

```python
def basis_change():
    """基变换示例"""
    # 标准基
    E = np.eye(2)
    
    # 新基
    B = np.array([
        [1, 1],
        [1, -1]
    ]).T  # 列向量
    
    # 变换矩阵 E → B
    P = np.linalg.inv(B)
    
    # 向量在标准基下的坐标
    v_E = np.array([3, 1])
    
    # 转换到新基
    v_B = P @ v_E
    
    print(f"标准基下: {v_E}")
    print(f"新基下: {v_B}")
    
    # 验证
    v_reconstructed = B @ v_B
    print(f"验证: {v_reconstructed}")  # 应该等于 v_E

basis_change()
```

### 4.6 向量空间的应用

#### 最小二乘投影

**问题**：$b$ 不在 $C(A)$ 中，求最近的 $A\hat{x}$

$$
\hat{x} = (A^T A)^{-1} A^T b
$$

$$
\text{投影} = A\hat{x}
$$

```python
def projection_demo():
    """投影演示"""
    # 列空间（平面）
    A = np.array([
        [1, 0],
        [0, 1],
        [0, 0]
    ], dtype=float)
    
    # 不在列空间中的向量
    b = np.array([1, 1, 1])
    
    # 投影
    P = A @ np.linalg.inv(A.T @ A) @ A.T
    projection = P @ b
    
    print(f"原向量: {b}")
    print(f"投影: {projection}")  # [1, 1, 0]
    print(f"误差: {b - projection}")  # [0, 0, 1]

projection_demo()
```

---

**本章完**
