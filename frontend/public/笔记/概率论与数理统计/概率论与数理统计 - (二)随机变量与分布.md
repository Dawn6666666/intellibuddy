# 概率论与数理统计 - (二)随机变量与分布

掌握离散和连续随机变量的分布。

---

## 2. 随机变量与分布

### 2.1 随机变量的概念

#### 定义

**随机变量**：定义在样本空间 $\Omega$ 上的实值函数 $X: \Omega \to \mathbb{R}$

$$
X: \omega \mapsto X(\omega)
$$

将随机试验的结果映射为实数。

**示例：**

**例1**：抛硬币两次

样本空间：$\Omega = \{HH, HT, TH, TT\}$

定义随机变量 $X$ = "正面出现次数"

$$
\begin{aligned}
X(HH) &= 2 \\
X(HT) = X(TH) &= 1 \\
X(TT) &= 0
\end{aligned}
$$

#### 随机变量的分类

**离散型随机变量**：取值为有限个或可数无穷个

**连续型随机变量**：取值为某个区间内的所有实数

### 2.2 分布函数

#### 定义

**分布函数**（Cumulative Distribution Function, CDF）：

$$
F(x) = P(X \leq x), \quad x \in \mathbb{R}
$$

描述随机变量"不超过某个值"的概率。

#### 分布函数的性质

**性质1**（单调性）：$F(x)$ 单调非减

若 $x_1 < x_2$，则 $F(x_1) \leq F(x_2)$

**性质2**（有界性）：

$$
\lim_{x \to -\infty} F(x) = 0, \quad \lim_{x \to +\infty} F(x) = 1
$$

即 $0 \leq F(x) \leq 1$

**性质3**（右连续性）：

$$
\lim_{x \to a^+} F(x) = F(a)
$$

**性质4**（区间概率）：

$$
P(a < X \leq b) = F(b) - F(a)
$$

$$
P(X = a) = F(a) - F(a^-)
$$

**例2**：设随机变量 $X$ 的分布函数为

$$
F(x) = \begin{cases}
0, & x < 0 \\
x^2, & 0 \leq x < 1 \\
1, & x \geq 1
\end{cases}
$$

求 $P(0.25 < X \leq 0.75)$

**解**：

$$
P(0.25 < X \leq 0.75) = F(0.75) - F(0.25) = (0.75)^2 - (0.25)^2 = 0.5625 - 0.0625 = 0.5
$$

### 2.3 离散型随机变量

#### 概率质量函数

**概率质量函数**（Probability Mass Function, PMF）：

$$
p_i = P(X = x_i), \quad i = 1, 2, \ldots
$$

满足：

1. $p_i \geq 0$
2. $\sum_{i} p_i = 1$

**分布函数与PMF的关系**：

$$
F(x) = \sum_{x_i \leq x} p_i
$$

#### 常见离散分布

##### (1) 0-1分布（伯努利分布）

$X \sim \text{Bernoulli}(p)$，$X \in \{0, 1\}$

$$
P(X = k) = p^k (1-p)^{1-k}, \quad k = 0, 1
$$

$$
E[X] = p, \quad \text{Var}(X) = p(1-p)
$$

**应用**：单次试验成功/失败

##### (2) 二项分布

$X \sim B(n, p)$（$n$ 次独立重复伯努利试验成功次数）

$$
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}, \quad k = 0, 1, \ldots, n
$$

$$
E[X] = np, \quad \text{Var}(X) = np(1-p)
$$

**性质**：
- $n = 1$ 时退化为伯努利分布
- 可加性：若 $X_1 \sim B(n_1, p)$，$X_2 \sim B(n_2, p)$ 独立，则 $X_1 + X_2 \sim B(n_1 + n_2, p)$

**例3**：某射手命中率80%，射击10次，求恰好命中8次的概率。

**解**：

$X \sim B(10, 0.8)$

$$
P(X = 8) = \binom{10}{8} (0.8)^8 (0.2)^2 = 45 \times 0.16777216 \times 0.04 \approx 0.302
$$

##### (3) 泊松分布

$X \sim \text{Poisson}(\lambda)$（单位时间/空间内事件发生次数）

$$
P(X = k) = \frac{\lambda^k e^{-\lambda}}{k!}, \quad k = 0, 1, 2, \ldots
$$

$$
E[X] = \lambda, \quad \text{Var}(X) = \lambda
$$

**参数意义**：$\lambda$ = 平均发生率

**泊松定理**（泊松近似）：

当 $n$ 很大，$p$ 很小，$np = \lambda$ 适中时，

$$
B(n, p) \approx \text{Poisson}(\lambda)
$$

即：

$$
\binom{n}{k} p^k (1-p)^{n-k} \approx \frac{\lambda^k e^{-\lambda}}{k!}
$$

**应用场景**：
- 单位时间内电话呼叫次数
- 单位面积内细菌数
- 网站访问量
- 放射性衰变

**例4**：某网站平均每分钟有3次访问，求1分钟内访问次数超过5次的概率。

**解**：

$X \sim \text{Poisson}(3)$

$$
\begin{aligned}
P(X > 5) &= 1 - P(X \leq 5) \\
&= 1 - \sum_{k=0}^{5} \frac{3^k e^{-3}}{k!} \\
&= 1 - e^{-3} \left(1 + 3 + \frac{9}{2} + \frac{9}{2} + \frac{27}{8} + \frac{81}{40}\right) \\
&\approx 1 - 0.916 \\
&\approx 0.084
\end{aligned}
$$

##### (4) 几何分布

$X \sim \text{Geom}(p)$（首次成功所需试验次数）

$$
P(X = k) = (1-p)^{k-1} p, \quad k = 1, 2, \ldots
$$

$$
E[X] = \frac{1}{p}, \quad \text{Var}(X) = \frac{1-p}{p^2}
$$

**无记忆性**：

$$
P(X > m + n | X > m) = P(X > n)
$$

**例5**：掷骰子直到出现6，求期望投掷次数。

**解**：

$X \sim \text{Geom}(1/6)$

$$
E[X] = \frac{1}{1/6} = 6
$$

##### (5) 超几何分布

从 $N$ 个元素（其中 $M$ 个"成功"）中不放回抽取 $n$ 个，成功个数 $X \sim \text{Hypergeom}(N, M, n)$

$$
P(X = k) = \frac{\binom{M}{k} \binom{N-M}{n-k}}{\binom{N}{n}}
$$

$$
E[X] = n \frac{M}{N}, \quad \text{Var}(X) = n \frac{M}{N} \frac{N-M}{N} \frac{N-n}{N-1}
$$

**与二项分布的关系**：

当 $N \to \infty$，$M/N \to p$ 时，$\text{Hypergeom}(N, M, n) \to B(n, p)$

**例6**：52张扑克牌中抽5张，求恰有2张红心的概率。

**解**：

$X \sim \text{Hypergeom}(52, 13, 5)$

$$
P(X = 2) = \frac{\binom{13}{2} \binom{39}{3}}{\binom{52}{5}} = \frac{78 \times 9139}{2598960} \approx 0.274
$$

### 2.4 连续型随机变量

#### 概率密度函数

**概率密度函数**（Probability Density Function, PDF）：

若存在非负函数 $f(x)$ 使得

$$
F(x) = P(X \leq x) = \int_{-\infty}^{x} f(t) \, dt
$$

则称 $X$ 为连续型随机变量，$f(x)$ 为其概率密度函数。

**性质**：

1. $f(x) \geq 0$
2. $\int_{-\infty}^{+\infty} f(x) \, dx = 1$
3. $P(a < X < b) = \int_a^b f(x) \, dx$
4. $P(X = a) = 0$（单点概率为0）
5. $f(x) = F'(x)$（在连续点处）

**注意**：$f(x)$ 本身不是概率，可以大于1！

#### 常见连续分布

##### (1) 均匀分布

$X \sim U(a, b)$（在区间 $[a, b]$ 上均匀分布）

$$
f(x) = \begin{cases}
\frac{1}{b-a}, & a \leq x \leq b \\
0, & \text{其他}
\end{cases}
$$

$$
F(x) = \begin{cases}
0, & x < a \\
\frac{x-a}{b-a}, & a \leq x < b \\
1, & x \geq b
\end{cases}
$$

$$
E[X] = \frac{a+b}{2}, \quad \text{Var}(X) = \frac{(b-a)^2}{12}
$$

**应用**：随机数生成、蒙特卡洛模拟

##### (2) 指数分布

$X \sim \text{Exp}(\lambda)$（等待时间、寿命）

$$
f(x) = \begin{cases}
\lambda e^{-\lambda x}, & x \geq 0 \\
0, & x < 0
\end{cases}
$$

$$
F(x) = \begin{cases}
1 - e^{-\lambda x}, & x \geq 0 \\
0, & x < 0
\end{cases}
$$

$$
E[X] = \frac{1}{\lambda}, \quad \text{Var}(X) = \frac{1}{\lambda^2}
$$

**无记忆性**（唯一连续分布具有此性质）：

$$
P(X > s + t | X > s) = P(X > t)
$$

**例7**：灯泡寿命服从 $\text{Exp}(0.001)$（单位：小时），求

(1) 寿命超过1000小时的概率
(2) 已使用500小时，再使用500小时以上的概率

**解**：

(1) 
$$
P(X > 1000) = 1 - F(1000) = e^{-0.001 \times 1000} = e^{-1} \approx 0.368
$$

(2) 由无记忆性：

$$
P(X > 1000 | X > 500) = P(X > 500) = e^{-0.5} \approx 0.606
$$

##### (3) 正态分布

$X \sim N(\mu, \sigma^2)$（最重要的连续分布）

$$
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, \quad x \in \mathbb{R}
$$

**参数**：
- $\mu$：均值（位置参数）
- $\sigma^2$：方差（尺度参数）

$$
E[X] = \mu, \quad \text{Var}(X) = \sigma^2
$$

**标准正态分布**：$Z \sim N(0, 1)$

$$
\varphi(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}
$$

$$
\Phi(x) = \int_{-\infty}^{x} \varphi(t) \, dt = P(Z \leq x)
$$

**标准化变换**：

若 $X \sim N(\mu, \sigma^2)$，则

$$
Z = \frac{X - \mu}{\sigma} \sim N(0, 1)
$$

因此：

$$
P(X \leq x) = P\left(Z \leq \frac{x - \mu}{\sigma}\right) = \Phi\left(\frac{x - \mu}{\sigma}\right)
$$

**性质**：

1. 对称性：$\Phi(-x) = 1 - \Phi(x)$
2. $\Phi(0) = 0.5$
3. 线性变换：若 $X \sim N(\mu, \sigma^2)$，则 $aX + b \sim N(a\mu + b, a^2\sigma^2)$

**3σ原则**：

$$
\begin{aligned}
P(|X - \mu| \leq \sigma) &= P(-1 \leq Z \leq 1) \approx 0.6827 \\
P(|X - \mu| \leq 2\sigma) &= P(-2 \leq Z \leq 2) \approx 0.9545 \\
P(|X - \mu| \leq 3\sigma) &= P(-3 \leq Z \leq 3) \approx 0.9973
\end{aligned}
$$

**例8**：某产品重量 $X \sim N(500, 10^2)$ 克，求重量在480~520克之间的概率。

**解**：

标准化：

$$
P(480 < X < 520) = P\left(\frac{480-500}{10} < Z < \frac{520-500}{10}\right) = P(-2 < Z < 2)
$$

$$
= \Phi(2) - \Phi(-2) = \Phi(2) - (1 - \Phi(2)) = 2\Phi(2) - 1 \approx 2 \times 0.9772 - 1 = 0.9544
$$

##### (4) Gamma分布

$X \sim \text{Gamma}(\alpha, \lambda)$（等待时间的推广）

$$
f(x) = \frac{\lambda^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x}, \quad x > 0
$$

其中 $\Gamma(\alpha) = \int_0^\infty t^{\alpha-1} e^{-t} \, dt$（Gamma函数）

$$
E[X] = \frac{\alpha}{\lambda}, \quad \text{Var}(X) = \frac{\alpha}{\lambda^2}
$$

**特殊情况**：
- $\alpha = 1$：指数分布 $\text{Exp}(\lambda)$
- $\alpha = n/2$，$\lambda = 1/2$：卡方分布 $\chi^2(n)$

##### (5) Beta分布

$X \sim \text{Beta}(\alpha, \beta)$（定义在 $[0, 1]$ 上）

$$
f(x) = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)} x^{\alpha-1} (1-x)^{\beta-1}, \quad 0 < x < 1
$$

$$
E[X] = \frac{\alpha}{\alpha + \beta}, \quad \text{Var}(X) = \frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}
$$

**应用**：贝叶斯统计中的先验分布

##### (6) 柯西分布

$X \sim \text{Cauchy}(x_0, \gamma)$

$$
f(x) = \frac{1}{\pi\gamma \left[1 + \left(\frac{x-x_0}{\gamma}\right)^2\right]}
$$

**特点**：均值和方差都不存在（积分不收敛）

### 2.5 随机变量的数字特征

#### 数学期望（均值）

**离散型**：

$$
E[X] = \sum_{i} x_i P(X = x_i)
$$

**连续型**：

$$
E[X] = \int_{-\infty}^{+\infty} x f(x) \, dx
$$

**随机变量函数的期望**：

$$
E[g(X)] = \begin{cases}
\sum_i g(x_i) P(X = x_i), & \text{离散} \\
\int_{-\infty}^{+\infty} g(x) f(x) \, dx, & \text{连续}
\end{cases}
$$

**性质**：

1. $E[c] = c$（常数）
2. $E[aX + b] = aE[X] + b$（线性性）
3. $E[X + Y] = E[X] + E[Y]$（可加性，总成立）
4. 若 $X, Y$ 独立，则 $E[XY] = E[X]E[Y]$

#### 方差

**定义**：

$$
\text{Var}(X) = E[(X - E[X])^2] = E[X^2] - (E[X])^2
$$

**计算技巧**：

$$
\text{Var}(X) = E[X^2] - (E[X])^2
$$

通常先算 $E[X^2]$ 和 $E[X]$，再用上式。

**标准差**：$\sigma = \sqrt{\text{Var}(X)}$

**性质**：

1. $\text{Var}(c) = 0$
2. $\text{Var}(aX + b) = a^2 \text{Var}(X)$
3. 若 $X, Y$ 独立，则 $\text{Var}(X + Y) = \text{Var}(X) + \text{Var}(Y)$

**例9**：设 $X \sim B(n, p)$，求 $E[X]$ 和 $\text{Var}(X)$

**解法1**（直接计算）：

$$
E[X] = \sum_{k=0}^{n} k \binom{n}{k} p^k (1-p)^{n-k}
$$

利用 $k\binom{n}{k} = n\binom{n-1}{k-1}$：

$$
E[X] = np \sum_{k=1}^{n} \binom{n-1}{k-1} p^{k-1} (1-p)^{n-k} = np
$$

**解法2**（利用分解）：

设 $X = X_1 + X_2 + \cdots + X_n$，其中 $X_i \sim \text{Bernoulli}(p)$

$$
E[X] = \sum_{i=1}^{n} E[X_i] = np
$$

$$
\text{Var}(X) = \sum_{i=1}^{n} \text{Var}(X_i) = n \cdot p(1-p)
$$

#### 高阶矩

**$k$ 阶原点矩**：

$$
\mu_k = E[X^k]
$$

**$k$ 阶中心矩**：

$$
\nu_k = E[(X - E[X])^k]
$$

特别地：
- $\mu_1 = E[X]$（期望）
- $\nu_2 = \text{Var}(X)$（方差）
- $\nu_3$：偏度（Skewness），衡量分布的对称性
- $\nu_4$：峰度（Kurtosis），衡量分布的尖峭程度

#### 矩母函数（MGF）

**定义**：

$$
M_X(t) = E[e^{tX}]
$$

**性质**：

1. $M_X^{(k)}(0) = E[X^k]$（第 $k$ 阶导数在0处的值）
2. 若 $Y = aX + b$，则 $M_Y(t) = e^{bt} M_X(at)$
3. 若 $X, Y$ 独立，则 $M_{X+Y}(t) = M_X(t) M_Y(t)$
4. **唯一性**：MGF唯一确定分布

**示例**：

**标准正态分布** $Z \sim N(0, 1)$：

$$
M_Z(t) = E[e^{tZ}] = \int_{-\infty}^{+\infty} e^{tx} \frac{1}{\sqrt{2\pi}} e^{-x^2/2} \, dx = e^{t^2/2}
$$

**一般正态分布** $X \sim N(\mu, \sigma^2)$：

$$
X = \mu + \sigma Z \Rightarrow M_X(t) = e^{\mu t} M_Z(\sigma t) = e^{\mu t + \sigma^2 t^2 / 2}
$$

#### 特征函数

**定义**：

$$
\phi_X(t) = E[e^{itX}] = \int_{-\infty}^{+\infty} e^{itx} f(x) \, dx
$$

（$i$ 为虚数单位，$i^2 = -1$）

**优点**：
- 总是存在（与MGF不同）
- 与傅里叶变换密切相关

**性质**：
1. $|\phi_X(t)| \leq 1$
2. $\phi_X(0) = 1$
3. 唯一性
4. $\phi_{aX+b}(t) = e^{itb} \phi_X(at)$

### 2.6 常见分布族总结

#### 离散分布族

| 分布 | 参数 | PMF | $E[X]$ | $\text{Var}(X)$ | 应用 |
|------|------|-----|--------|------------------|------|
| 伯努利 | $p$ | $p^x(1-p)^{1-x}$ | $p$ | $p(1-p)$ | 单次试验 |
| 二项 | $n, p$ | $\binom{n}{k}p^k(1-p)^{n-k}$ | $np$ | $np(1-p)$ | 重复试验成功次数 |
| 泊松 | $\lambda$ | $\frac{\lambda^k e^{-\lambda}}{k!}$ | $\lambda$ | $\lambda$ | 稀有事件计数 |
| 几何 | $p$ | $(1-p)^{k-1}p$ | $1/p$ | $(1-p)/p^2$ | 首次成功试验次数 |
| 超几何 | $N,M,n$ | $\frac{\binom{M}{k}\binom{N-M}{n-k}}{\binom{N}{n}}$ | $n\frac{M}{N}$ | 复杂 | 不放回抽样 |

#### 连续分布族

| 分布 | 参数 | PDF | $E[X]$ | $\text{Var}(X)$ | 应用 |
|------|------|-----|--------|------------------|------|
| 均匀 | $a, b$ | $\frac{1}{b-a}$ | $\frac{a+b}{2}$ | $\frac{(b-a)^2}{12}$ | 随机数生成 |
| 指数 | $\lambda$ | $\lambda e^{-\lambda x}$ | $1/\lambda$ | $1/\lambda^2$ | 等待时间 |
| 正态 | $\mu, \sigma^2$ | $\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$ | $\mu$ | $\sigma^2$ | 自然现象 |
| Gamma | $\alpha, \lambda$ | $\frac{\lambda^\alpha}{\Gamma(\alpha)}x^{\alpha-1}e^{-\lambda x}$ | $\alpha/\lambda$ | $\alpha/\lambda^2$ | 等待时间和 |
| Beta | $\alpha, \beta$ | $\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1-x)^{\beta-1}$ | $\frac{\alpha}{\alpha+\beta}$ | 复杂 | 概率的分布 |

#### 分布之间的关系

```
二项 B(n,p) ──n大p小──> 泊松 Poisson(np)
     │
     │ n→∞
     ↓
   正态 N(np, np(1-p))

Gamma(1, λ) = 指数 Exp(λ)

Gamma(n/2, 1/2) = 卡方 χ²(n)

超几何 ──N→∞──> 二项
```

### 2.7 应用实例

#### 应用1：分布可视化

```python
from scipy import stats
import matplotlib.pyplot as plt
import numpy as np

def plot_distributions():
    """可视化常见分布"""
    fig, axes = plt.subplots(2, 3, figsize=(15, 10))
    
    # 二项分布
    n, p = 20, 0.5
    x = np.arange(0, n+1)
    axes[0, 0].bar(x, stats.binom.pmf(x, n, p), alpha=0.7)
    axes[0, 0].set_title(f'二项分布 B({n}, {p})')
    axes[0, 0].set_xlabel('k')
    axes[0, 0].set_ylabel('P(X=k)')
    axes[0, 0].grid(alpha=0.3)
    
    # 泊松分布
    lambda_ = 5
    x = np.arange(0, 20)
    axes[0, 1].bar(x, stats.poisson.pmf(x, lambda_), alpha=0.7, color='orange')
    axes[0, 1].set_title(f'泊松分布 Poisson({lambda_})')
    axes[0, 1].set_xlabel('k')
    axes[0, 1].set_ylabel('P(X=k)')
    axes[0, 1].grid(alpha=0.3)
    
    # 几何分布
    p = 0.3
    x = np.arange(1, 21)
    axes[0, 2].bar(x, stats.geom.pmf(x, p), alpha=0.7, color='green')
    axes[0, 2].set_title(f'几何分布 Geom({p})')
    axes[0, 2].set_xlabel('k')
    axes[0, 2].set_ylabel('P(X=k)')
    axes[0, 2].grid(alpha=0.3)
    
    # 正态分布
    x = np.linspace(-4, 4, 1000)
    axes[1, 0].plot(x, stats.norm.pdf(x, 0, 1), linewidth=2)
    axes[1, 0].fill_between(x, stats.norm.pdf(x, 0, 1), alpha=0.3)
    axes[1, 0].set_title('标准正态分布 N(0, 1)')
    axes[1, 0].set_xlabel('x')
    axes[1, 0].set_ylabel('f(x)')
    axes[1, 0].grid(alpha=0.3)
    
    # 指数分布
    x = np.linspace(0, 5, 1000)
    for lam in [0.5, 1, 2]:
        axes[1, 1].plot(x, stats.expon.pdf(x, scale=1/lam), label=f'λ={lam}')
    axes[1, 1].set_title('指数分布 Exp(λ)')
    axes[1, 1].set_xlabel('x')
    axes[1, 1].set_ylabel('f(x)')
    axes[1, 1].legend()
    axes[1, 1].grid(alpha=0.3)
    
    # Gamma分布
    x = np.linspace(0, 20, 1000)
    for alpha in [1, 2, 5]:
        axes[1, 2].plot(x, stats.gamma.pdf(x, alpha, scale=1), label=f'α={alpha}')
    axes[1, 2].set_title('Gamma分布 (λ=1)')
    axes[1, 2].set_xlabel('x')
    axes[1, 2].set_ylabel('f(x)')
    axes[1, 2].legend()
    axes[1, 2].grid(alpha=0.3)
    
    plt.tight_layout()
    # plt.savefig('distributions.png', dpi=300)
    # plt.show()

# plot_distributions()  # 取消注释运行
```

#### 应用2：服务器队列模拟

基于泊松到达和指数服务时间的M/M/1队列。

```python
def simulate_server_queue(arrival_rate=5, service_rate=8, duration=100):
    """
    模拟服务器队列（M/M/1队列）
    arrival_rate: 平均每秒到达请求数（λ）
    service_rate: 平均每秒处理请求数（μ）
    duration: 模拟时长（秒）
    """
    import numpy as np
    
    current_time = 0
    queue = []
    wait_times = []
    
    # 生成到达时间（泊松过程 = 指数分布间隔）
    inter_arrival_times = np.random.exponential(1/arrival_rate, int(duration * arrival_rate * 2))
    arrival_times = np.cumsum(inter_arrival_times)
    
    # 生成服务时间
    service_times = np.random.exponential(1/service_rate, len(arrival_times))
    
    server_busy_until = 0
    
    for i, arrival_time in enumerate(arrival_times):
        if arrival_time > duration:
            break
        
        # 计算等待时间
        if server_busy_until > arrival_time:
            wait_time = server_busy_until - arrival_time
        else:
            wait_time = 0
        
        wait_times.append(wait_time)
        
        # 更新服务器忙碌时间
        start_service = max(arrival_time, server_busy_until)
        server_busy_until = start_service + service_times[i]
    
    # 理论值（M/M/1队列公式）
    rho = arrival_rate / service_rate  # 利用率
    if rho < 1:
        theoretical_wait = rho / (service_rate - arrival_rate)
        theoretical_queue = rho / (1 - rho)
    else:
        theoretical_wait = float('inf')
        theoretical_queue = float('inf')
    
    avg_wait = np.mean(wait_times)
    
    print(f"=== M/M/1 队列模拟 ===")
    print(f"到达率 λ = {arrival_rate}/秒")
    print(f"服务率 μ = {service_rate}/秒")
    print(f"利用率 ρ = {rho:.3f}")
    print(f"\n平均等待时间:")
    print(f"  模拟值: {avg_wait:.4f}秒")
    print(f"  理论值: {theoretical_wait:.4f}秒")
    print(f"最大等待时间: {max(wait_times):.4f}秒")
    print(f"处理请求数: {len(wait_times)}")
    
    return wait_times

# wait_times = simulate_server_queue()  # 取消注释运行
```

### 2.8 本章小结

#### 核心概念

1. **随机变量**：将随机试验结果映射为实数
2. **分布函数**：$F(x) = P(X \leq x)$，完整刻画分布
3. **离散型**：PMF，关键分布（二项、泊松、几何）
4. **连续型**：PDF，关键分布（正态、指数、均匀）
5. **数字特征**：期望、方差、矩
6. **MGF与特征函数**：生成矩、唯一确定分布

#### 重要公式

**期望与方差**：

$$
E[aX + b] = aE[X] + b
$$

$$
\text{Var}(aX + b) = a^2 \text{Var}(X)
$$

$$
\text{Var}(X) = E[X^2] - (E[X])^2
$$

**正态分布标准化**：

$$
X \sim N(\mu, \sigma^2) \Rightarrow Z = \frac{X - \mu}{\sigma} \sim N(0, 1)
$$

**泊松近似**：

$$
B(n, p) \approx \text{Poisson}(np) \quad (n \text{大}, p \text{小})
$$

#### 学习建议

1. **记住关键分布**：期望、方差、应用场景
2. **理解分布关系**：泊松近似、中心极限定理
3. **掌握计算技巧**：标准化、MGF、分解法
4. **实践应用**：编程模拟、数据拟合

---

**本章完**
