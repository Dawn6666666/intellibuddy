# ==========================================
# 智学伴 (IntelliBuddy) - 环境变量配置示例
# ==========================================
# 
# 使用说明：
# 1. 复制此文件并重命名为 `.env`
# 2. 填写所有必需的环境变量
# 3. 确保 `.env` 文件已添加到 `.gitignore`（避免泄露敏感信息）
# 
# 注意：
# - 必需变量：标记为 [必需] 的变量必须配置
# - 可选变量：标记为 [可选] 的变量可以不配置，系统会使用默认值
# ==========================================

# ------------------------------------------
# 基础配置
# ------------------------------------------

# [必需] 运行环境（development | production）
NODE_ENV=development

# [可选] 后端服务端口（默认：5001）
PORT=5001

# ------------------------------------------
# URL 配置
# ------------------------------------------

# [必需] 前端 URL（用于 OAuth 回调重定向）
# 开发环境：http://localhost:5173
# 生产环境：https://your-domain.vercel.app
FRONTEND_URL=http://localhost:5173

# [必需] 后端 URL（用于 OAuth 回调）
# 开发环境：http://localhost:5001
# 生产环境：https://your-domain.vercel.app
BACKEND_URL=http://localhost:5001

# ------------------------------------------
# 数据库配置
# ------------------------------------------

# [必需] MongoDB 连接字符串
# 获取方式：在 MongoDB Atlas 创建集群后获取
# 格式：mongodb+srv://<username>:<password>@<cluster>.mongodb.net/<database>?retryWrites=true&w=majority
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/intellibuddy?retryWrites=true&w=majority

# ------------------------------------------
# 身份认证配置
# ------------------------------------------

# [必需] JWT 密钥（用于生成和验证 token）
# 建议：使用随机字符串（至少 32 位）
# 生成方法：node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# ------------------------------------------
# AI 模型配置
# ------------------------------------------
# 说明：至少需要配置一个 AI 模型的 API Key
# 推荐配置多个模型，系统会自动实现降级切换

# [推荐] Kimi AI（月之暗面）
# 获取方式：https://platform.moonshot.cn/console/api-keys
KIMI_API_KEY=your-kimi-api-key

# [可选] 通义千问（阿里云）
# 获取方式：https://dashscope.console.aliyun.com/apiKey
QIANWEN_API_KEY=your-qianwen-api-key

# [可选] 文心一言（百度）
# 获取方式：https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application
ERNIE_API_KEY=your-ernie-api-key
ERNIE_SECRET_KEY=your-ernie-secret-key

# [可选] 智谱 AI (GLM)
# 获取方式：https://open.bigmodel.cn/usercenter/apikeys
ZHIPU_API_KEY=your-zhipu-api-key

# [可选] 主 AI 模型（kimi | qianwen | ernie | zhipu，默认：kimi）
PRIMARY_AI_MODEL=kimi

# [可选] 是否启用 AI 响应缓存（true | false，默认：false）
# 开启后可以节省 AI API 调用成本，但可能返回旧的答案
ENABLE_AI_CACHE=true

# ------------------------------------------
# 第三方登录配置（OAuth）
# ------------------------------------------

# [可选] GitHub 登录
# 获取方式：https://github.com/settings/developers
# 1. 创建 OAuth App
# 2. Authorization callback URL: http://localhost:5001/api/auth/github/callback (开发环境)
#                               或 https://your-domain.vercel.app/api/auth/github/callback (生产环境)
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# [可选] QQ 登录
# 获取方式：https://connect.qq.com/manage.html
# 1. 创建网站应用
# 2. 回调地址: http://localhost:5001/api/auth/qq/callback (开发环境)
#              或 https://your-domain.vercel.app/api/auth/qq/callback (生产环境)
QQ_APP_ID=your-qq-app-id
QQ_APP_KEY=your-qq-app-key

# ------------------------------------------
# 生产环境专用配置（仅在部署时需要）
# ------------------------------------------

# [生产环境] 是否信任代理（Vercel 等云平台部署时设置为 true）
TRUST_PROXY=true

# [生产环境] 允许的 CORS 来源（多个用逗号分隔）
# 示例：https://your-domain.vercel.app,https://www.your-domain.com
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:5174

# ------------------------------------------
# 可选功能配置
# ------------------------------------------

# [可选] 日志级别（debug | info | warn | error，默认：info）
LOG_LEVEL=info

# [可选] 限流配置（每分钟最大请求数）
RATE_LIMIT_MAX=100

# [可选] AI 限流配置（每分钟最大 AI 请求数）
AI_RATE_LIMIT_MAX=20

# ------------------------------------------
# Stripe 支付配置
# ------------------------------------------

# [必需] Stripe 密钥
# 获取方式：https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=your-stripe-secret-key

# [必需] Stripe Webhook 密钥
# 获取方式：https://dashboard.stripe.com/webhooks
# 用于验证 webhook 请求的真实性
STRIPE_WEBHOOK_SECRET=your-stripe-webhook-secret

# [必需] Stripe 价格 ID（创建产品后获取）
# 基础版 - 月付
STRIPE_PRICE_BASIC_MONTH=price_basic_month_id
# 基础版 - 年付
STRIPE_PRICE_BASIC_YEAR=price_basic_year_id
# 高级版 - 月付
STRIPE_PRICE_PREMIUM_MONTH=price_premium_month_id
# 高级版 - 年付
STRIPE_PRICE_PREMIUM_YEAR=price_premium_year_id
# 企业版 - 年付
STRIPE_PRICE_ENTERPRISE_YEAR=price_enterprise_year_id

# ==========================================
# 配置检查清单
# ==========================================
# 
# 开发环境必需配置：
# ✅ NODE_ENV
# ✅ MONGO_URI
# ✅ JWT_SECRET
# ✅ KIMI_API_KEY（或其他 AI 模型的 Key）
# ✅ FRONTEND_URL
# ✅ BACKEND_URL
# 
# 生产环境额外配置：
# ✅ 将所有 URL 改为生产环境域名
# ✅ 配置 TRUST_PROXY=true
# ✅ 配置 ALLOWED_ORIGINS（包含所有允许的前端域名）
# ✅ 更换 JWT_SECRET 为高强度密钥
# ✅ （可选）配置第三方登录的生产环境回调地址
# 
# ==========================================

