# 📚 IntelliBuddy 题库模板说明

## 📖 题库结构

每个知识点可以包含多个测验题目，支持以下三种题型：

### 1. 单选题 (single)
```typescript
{
  question: '问题描述',
  type: 'single',
  options: ['选项A', '选项B', '选项C', '选项D'],
  correctAnswer: 0,  // 正确答案的索引（0-3）
  explanation: '答案解析说明'
}
```

### 2. 多选题 (multiple)
```typescript
{
  question: '问题描述（可以多选）',
  type: 'multiple',
  options: ['选项A', '选项B', '选项C', '选项D'],
  correctAnswer: [0, 2],  // 正确答案的索引数组
  explanation: '答案解析说明'
}
```

### 3. 判断题 (boolean)
```typescript
{
  question: '判断题描述',
  type: 'boolean',
  options: ['正确', '错误'],
  correctAnswer: 0,  // 0=正确, 1=错误
  explanation: '答案解析说明'
}
```

## 🎯 编写题目的最佳实践

### 1. 题目质量
- ✅ **明确清晰**：问题表述准确，无歧义
- ✅ **难度适中**：匹配知识点的难度等级
- ✅ **考察重点**：聚焦核心概念和关键知识
- ✅ **实用性强**：贴近实际应用场景

### 2. 选项设计
- ✅ **长度相近**：避免通过长度判断答案
- ✅ **相互独立**：选项之间不重叠
- ✅ **干扰合理**：错误选项要有一定迷惑性
- ✅ **避免绝对**：少用"一定"、"绝对"等词

### 3. 答案解析
- ✅ **详细说明**：解释为什么选这个答案
- ✅ **知识扩展**：补充相关知识点
- ✅ **易于理解**：使用简洁的语言
- ✅ **举例说明**：适当使用示例

### 4. LaTeX 公式支持 ⭐
题目、选项和解析中都支持 **LaTeX 数学公式**，使用 KaTeX 渲染：

#### 基本语法
- **行内公式**：使用单个 `$` 包裹
  - 示例：`函数 $f(x) = x^2$ 的导数是 $f'(x) = 2x$`
  
- **块级公式**：使用双 `$$` 包裹（前后需要换行）
  ```markdown
  牛顿第二定律：
  
  $$
  F = ma
  $$
  
  其中 $F$ 是力...
  ```

#### 常用符号速查
- **分数**：`\frac{a}{b}` → $\frac{a}{b}$
- **根号**：`\sqrt{x}`, `\sqrt[n]{x}` → $\sqrt{x}$, $\sqrt[n]{x}$
- **上下标**：`x^2`, `x_i` → $x^2$, $x_i$
- **求和**：`\sum_{i=1}^{n}` → $\sum_{i=1}^{n}$
- **积分**：`\int_{a}^{b} f(x) \, dx` → $\int_{a}^{b} f(x) \, dx$
- **极限**：`\lim_{x \to \infty}` → $\lim_{x \to \infty}$
- **希腊字母**：`\alpha, \beta, \gamma, \theta, \lambda` → $\alpha, \beta, \gamma, \theta, \lambda$
- **不等式**：`\leq, \geq, \neq` → $\leq, \geq, \neq$

#### ⚠️ 注意事项
- ❌ **禁止使用** `\( \)` 或 `\[ \]` 格式（LaTeX 原生格式）
- ✅ **必须使用** `$` 或 `$$` 格式（Markdown + KaTeX）
- ✅ 在 JSON 中使用时，反斜杠需要转义：`\\frac{a}{b}`

## 📝 题库模板

### 基础模板（每个知识点 5 题）
```typescript
{
  pointId: 'xxx',  // 知识点ID
  quiz: [
    // 题目1：基础概念题（单选）
    {
      question: '',
      type: 'single',
      options: ['', '', '', ''],
      correctAnswer: 0,
      explanation: ''
    },
    // 题目2：深入理解题（多选）
    {
      question: '',
      type: 'multiple',
      options: ['', '', '', ''],
      correctAnswer: [0, 1],
      explanation: ''
    },
    // 题目3：判断题
    {
      question: '',
      type: 'boolean',
      options: ['正确', '错误'],
      correctAnswer: 0,
      explanation: ''
    },
    // 题目4：应用题（单选）
    {
      question: '',
      type: 'single',
      options: ['', '', '', ''],
      correctAnswer: 0,
      explanation: ''
    },
    // 题目5：综合题（单选）
    {
      question: '',
      type: 'single',
      options: ['', '', '', ''],
      correctAnswer: 0,
      explanation: ''
    }
  ]
}
```

## 🚀 使用方法

### 1. 编写题目
在 `backend/src/seed-quiz-data.ts` 中添加你的题库数据：

```typescript
const myQuizzes: QuizData[] = [
  {
    pointId: 'your-point-id',
    quiz: [
      // 在这里添加题目
    ]
  }
];

// 将你的题库添加到 allQuizData 中
const allQuizData: QuizData[] = [
  ...dataStructureQuizzes,
  ...myQuizzes,  // ← 添加到这里
];
```

### 2. 运行填充脚本
```bash
# 填充题库数据到数据库
cd backend
npx ts-node src/seed-quiz-data.ts

# 清空所有题库（谨慎使用）
npx ts-node src/seed-quiz-data.ts clear
```

### 3. 验证结果
```bash
# 查看某个知识点的题库
curl http://localhost:5001/api/quiz/ds101

# 提交测验答案
curl -X POST http://localhost:5001/api/quiz/submit \
  -H "Content-Type: application/json" \
  -d '{"pointId": "ds101", "answers": [0, [0,1,2,3], 0, 1, 1]}'
```

## 📊 题目数量建议

| 知识点难度 | 建议题目数 | 说明 |
|-----------|-----------|------|
| 基础（1-2） | 3-5 题 | 涵盖核心概念 |
| 中等（3） | 5-8 题 | 增加应用题 |
| 进阶（4-5） | 8-10 题 | 包含综合题 |

## 🎨 题型分配建议

对于 5 道题的标准配置：
- 💡 **单选题**: 3 题（60%）- 考察基础和应用
- 🎯 **多选题**: 1 题（20%）- 考察全面理解
- ✓ **判断题**: 1 题（20%）- 快速检验理解

对于 8-10 道题的进阶配置：
- 💡 **单选题**: 5-6 题
- 🎯 **多选题**: 2-3 题
- ✓ **判断题**: 1-2 题

## 💡 示例 1：完整的知识点题库（算法）

```typescript
{
  pointId: 'algo201',  // 算法 - 二分查找
  quiz: [
    {
      question: '二分查找的前提条件是什么？',
      type: 'single',
      options: [
        '数组必须是有序的',
        '数组必须是无序的',
        '数组长度必须是偶数',
        '数组元素必须唯一'
      ],
      correctAnswer: 0,
      explanation: '二分查找要求数组必须是有序的（升序或降序），这样才能通过比较中间元素来缩小搜索范围。'
    },
    {
      question: '二分查找的时间复杂度是多少？',
      type: 'single',
      options: ['O(1)', 'O(log n)', 'O(n)', 'O(n²)'],
      correctAnswer: 1,
      explanation: '二分查找每次将搜索范围缩小一半，时间复杂度为 $O(\\log n)$，是一种高效的查找算法。'
    },
    {
      question: '以下哪些情况适合使用二分查找？',
      type: 'multiple',
      options: [
        '在已排序数组中查找元素',
        '查找旋转数组的最小值',
        '在链表中查找元素',
        '在无序数组中查找元素'
      ],
      correctAnswer: [0, 1],
      explanation: '二分查找适用于有序数组和部分特殊数组（如旋转数组）。链表不支持随机访问，无序数组无法使用二分查找。'
    },
    {
      question: '在包含重复元素的有序数组中，二分查找无法使用。',
      type: 'boolean',
      options: ['正确', '错误'],
      correctAnswer: 1,
      explanation: '错误。二分查找可以在包含重复元素的有序数组中使用，但需要根据具体需求调整实现（如查找第一个或最后一个出现位置）。'
    },
    {
      question: '如果在长度为 1000 的有序数组中使用二分查找，最多需要比较多少次？',
      type: 'single',
      options: ['10 次', '100 次', '500 次', '1000 次'],
      correctAnswer: 0,
      explanation: '二分查找的最大比较次数为 $\\lceil \\log_2 n \\rceil$，对于 $n=1000$，$\\lceil \\log_2 1000 \\rceil = 10$ 次。'
    }
  ]
}
```

## 💡 示例 2：带 LaTeX 公式的数学题库

```typescript
{
  pointId: 'math301',  // 微积分
  quiz: [
    {
      question: '函数 $f(x) = x^3 - 3x^2 + 2$ 的导数是？',
      type: 'single',
      options: [
        '$f\'(x) = 3x^2 - 6x$',
        '$f\'(x) = 3x^2 + 6x$',
        '$f\'(x) = x^2 - 6x$',
        '$f\'(x) = 3x - 6$'
      ],
      correctAnswer: 0,
      explanation: '使用幂函数求导法则：$(x^n)\' = nx^{n-1}$，因此 $(x^3)\' = 3x^2$，$(3x^2)\' = 6x$，常数项导数为 0。'
    },
    {
      question: '定积分 $\\int_0^1 x^2 \\, dx$ 的值是多少？',
      type: 'single',
      options: [
        '$\\frac{1}{3}$',
        '$\\frac{1}{2}$',
        '$1$',
        '$\\frac{2}{3}$'
      ],
      correctAnswer: 0,
      explanation: '使用牛顿-莱布尼茨公式：$\\int_0^1 x^2 \\, dx = \\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{1}{3} - 0 = \\frac{1}{3}$'
    },
    {
      question: '以下哪些函数是初等函数？',
      type: 'multiple',
      options: [
        '$f(x) = e^x$',
        '$f(x) = \\ln x$',
        '$f(x) = \\sin x$',
        '$f(x) = |x|$'
      ],
      correctAnswer: [0, 1, 2, 3],
      explanation: '这些都是初等函数：指数函数 $e^x$、对数函数 $\\ln x$、三角函数 $\\sin x$ 和绝对值函数 $|x|$。'
    },
    {
      question: '极限 $\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1$',
      type: 'boolean',
      options: ['正确', '错误'],
      correctAnswer: 0,
      explanation: '正确。这是一个重要极限公式，常用于求解三角函数相关的极限问题。'
    },
    {
      question: '函数 $f(x) = x^2$ 在点 $(2, 4)$ 处的切线斜率是？',
      type: 'single',
      options: ['2', '4', '8', '16'],
      correctAnswer: 1,
      explanation: '切线斜率等于导数值。$f\'(x) = 2x$，在 $x=2$ 处，$f\'(2) = 4$。'
    }
  ]
}
```

## 💡 示例 3：物理题库（包含块级公式）

```typescript
{
  pointId: 'phys101',  // 经典力学
  quiz: [
    {
      question: '牛顿第二定律的表达式是什么？',
      type: 'single',
      options: [
        '$F = ma$',
        '$F = \\frac{mv^2}{r}$',
        '$E = mc^2$',
        '$p = mv$'
      ],
      correctAnswer: 0,
      explanation: '牛顿第二定律：物体的加速度与所受合力成正比，与质量成反比，即：\\n\\n$$\\nF = ma\\n$$\\n\\n其中 $F$ 是合力，$m$ 是质量，$a$ 是加速度。'
    },
    {
      question: '一个质量为 2kg 的物体，受到 10N 的力，其加速度是？',
      type: 'single',
      options: [
        '$5 \\text{ m/s}^2$',
        '$10 \\text{ m/s}^2$',
        '$20 \\text{ m/s}^2$',
        '$2 \\text{ m/s}^2$'
      ],
      correctAnswer: 0,
      explanation: '根据牛顿第二定律 $F = ma$，可得：\\n\\n$$\\na = \\frac{F}{m} = \\frac{10}{2} = 5 \\text{ m/s}^2\\n$$'
    },
    {
      question: '以下哪些物理量是矢量？',
      type: 'multiple',
      options: [
        '力 $\\vec{F}$',
        '速度 $\\vec{v}$',
        '时间 $t$',
        '加速度 $\\vec{a}$'
      ],
      correctAnswer: [0, 1, 3],
      explanation: '矢量既有大小又有方向。力、速度、加速度都是矢量，而时间只有大小，是标量。'
    }
  ]
}
```

## 🔍 常见问题

### Q: 如何确定题目的难度？
A: 根据知识点的 difficulty 字段（1-5）来设计题目难度：
- 1-2: 基础概念识记
- 3: 理解应用
- 4-5: 综合分析

### Q: 需要为每个知识点都添加题目吗？
A: 不是必须的，但建议至少为主要知识点添加 3-5 道题，以便学生自测。

### Q: 可以动态添加题目吗？
A: 可以！随时运行 `seed-quiz-data.ts` 脚本更新题库。

### Q: 如何测试题目是否正确？
A: 
1. 使用 API 测试工具（Postman/curl）
2. 在前端界面实际答题
3. 检查答案解析是否显示正确

## 📞 技术支持

如有问题，请参考：
- API 文档: `backend/src/routes/quiz.ts`
- 数据模型: `backend/src/models/KnowledgePoint.ts`
- 示例数据: `backend/src/seed-quiz-data.ts`

