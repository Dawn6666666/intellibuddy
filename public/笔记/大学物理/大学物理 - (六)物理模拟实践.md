![(六)物理模拟实践](https://via.placeholder.com/800x200?text=Physics+Simulation)

# 大学物理 - (六)物理模拟实践

用Python模拟物理现象。

---


### 6.1 粒子系统（游戏开发）

```python
class Particle:
    def __init__(self, pos, vel, mass=1.0):
        self.pos = np.array(pos, dtype=float)
        self.vel = np.array(vel, dtype=float)
        self.mass = mass
    
    def update(self, force, dt):
        """欧拉法更新"""
        acc = force / self.mass
        self.vel += acc * dt
        self.pos += self.vel * dt

class ParticleSystem:
    def __init__(self):
        self.particles = []
    
    def add_particle(self, particle):
        self.particles.append(particle)
    
    def simulate(self, force_func, dt, steps):
        """模拟粒子运动"""
        positions = []
        for _ in range(steps):
            for p in self.particles:
                force = force_func(p)
                p.update(force, dt)
            positions.append([p.pos.copy() for p in self.particles])
        return positions

# 重力场
def gravity(particle):
    return np.array([0, -9.8 * particle.mass])

# 创建系统
system = ParticleSystem()
system.add_particle(Particle(pos=[0, 10], vel=[5, 0]))

# 模拟
positions = system.simulate(gravity, dt=0.01, steps=200)

# 可视化
positions = np.array(positions)
plt.plot(positions[:, 0, 0], positions[:, 0, 1])
plt.xlabel('x (m)')
plt.ylabel('y (m)')
plt.title('粒子轨迹')
plt.grid()
plt.show()
```

### 6.2 弹簧-质点系统

```python
def spring_mass_damper(k=10, m=1, c=0.5, x0=1, v0=0, t_max=10):
    """弹簧-质点-阻尼系统"""
    omega0 = np.sqrt(k / m)
    zeta = c / (2 * np.sqrt(k * m))  # 阻尼比
    
    if zeta < 1:  # 欠阻尼
        omega_d = omega0 * np.sqrt(1 - zeta**2)
        t = np.linspace(0, t_max, 1000)
        x = np.exp(-zeta * omega0 * t) * (
            x0 * np.cos(omega_d * t) + 
            (v0 + zeta * omega0 * x0) / omega_d * np.sin(omega_d * t)
        )
    elif zeta == 1:  # 临界阻尼
        t = np.linspace(0, t_max, 1000)
        x = (x0 + (v0 + omega0 * x0) * t) * np.exp(-omega0 * t)
    else:  # 过阻尼
        t = np.linspace(0, t_max, 1000)
        s1 = -omega0 * (zeta + np.sqrt(zeta**2 - 1))
        s2 = -omega0 * (zeta - np.sqrt(zeta**2 - 1))
        x = ((v0 - s2*x0)/(s1-s2)) * np.exp(s1*t) + ((s1*x0 - v0)/(s1-s2)) * np.exp(s2*t)
    
    plt.plot(t, x)
    plt.xlabel('时间 (s)')
    plt.ylabel('位移 (m)')
    plt.title(f'弹簧-质点系统 (ζ={zeta:.2f})')
    plt.grid()
    plt.show()

spring_mass_damper(k=10, m=1, c=0.5)  # 欠阻尼
```

### 6.3 N体问题（天体模拟）

```python
def n_body_simulation(bodies, G, dt, steps):
    """N体引力模拟"""
    positions = []
    
    for _ in range(steps):
        forces = [np.zeros(2) for _ in bodies]
        
        # 计算所有天体间的引力
        for i, body1 in enumerate(bodies):
            for j, body2 in enumerate(bodies):
                if i != j:
                    r = body2['pos'] - body1['pos']
                    dist = np.linalg.norm(r)
                    F = G * body1['mass'] * body2['mass'] / dist**2
                    forces[i] += F * r / dist
        
        # 更新位置和速度
        for i, body in enumerate(bodies):
            acc = forces[i] / body['mass']
            body['vel'] += acc * dt
            body['pos'] += body['vel'] * dt
        
        positions.append([b['pos'].copy() for b in bodies])
    
    return np.array(positions)

# 太阳-地球系统（简化）
bodies = [
    {'pos': np.array([0.0, 0.0]), 'vel': np.array([0.0, 0.0]), 'mass': 1.989e30},  # 太阳
    {'pos': np.array([1.496e11, 0.0]), 'vel': np.array([0.0, 2.98e4]), 'mass': 5.972e24}  # 地球
]

positions = n_body_simulation(bodies, G=6.67e-11, dt=86400, steps=365)

# 绘制轨道
plt.plot(positions[:, 0, 0], positions[:, 0, 1], 'yo', markersize=10, label='太阳')
plt.plot(positions[:, 1, 0], positions[:, 1, 1], 'b-', label='地球')
plt.xlabel('x (m)')
plt.ylabel('y (m)')
plt.title('地球绕太阳运动')
plt.legend()
plt.axis('equal')
plt.grid()
plt.show()
```

---

## 📚 学习建议

### 理论与编程结合

**学习路径：**

```
物理概念 → 数学推导 → 编程模拟 → 实际应用
```

### 重点内容

| 章节 | 重点 | 编程应用 |
|------|------|----------|
| 力学 | 运动方程、能量守恒 | 游戏物理引擎 |
| 电磁学 | 电路定律 | 电路分析软件 |
| 光学 | 折射、反射 | 光线追踪渲染 |
| 量子力学 | 叠加态、测量 | 量子计算模拟 |

### 实践项目

1. **2D物理引擎**
   - 实现刚体碰撞
   - 添加重力、摩擦力
   - 渲染运动轨迹

2. **光线追踪器**
   - 反射、折射
   - 阴影计算
   - Phong光照

3. **电路模拟器**
   - 节点电压法
   - 可视化电路图
   - 交互式设计

### 推荐资源

📖 **教材：**
- 《大学物理》- 程守洙、江之永
- 《费曼物理学讲义》

🎥 **视频：**
- MIT 8.01 Classical Mechanics
- 3Blue1Brown 量子力学系列

💻 **编程库：**
- `pygame`（游戏物理）
- `pymunk`（2D物理引擎）
- `qiskit`（量子计算）

---

## 附录：常用物理常数

| 常数 | 符号 | 数值 |
|------|------|------|
| 光速 | $c$ | $3.0 \times 10^8$ m/s |
| 万有引力常数 | $G$ | $6.67 \times 10^{-11}$ N·m²/kg² |
| 普朗克常数 | $h$ | $6.63 \times 10^{-34}$ J·s |
| 电子质量 | $m_e$ | $9.11 \times 10^{-31}$ kg |
| 质子质量 | $m_p$ | $1.67 \times 10^{-27}$ kg |
| 电子电荷 | $e$ | $1.6 \times 10^{-19}$ C |
| 真空介电常数 | $\epsilon_0$ | $8.85 \times 10^{-12}$ F/m |
| 真空磁导率 | $\mu_0$ | $4\pi \times 10^{-7}$ H/m |

---

## 7. 流体力学