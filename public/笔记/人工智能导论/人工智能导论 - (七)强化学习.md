![(七)强化学习](https://via.placeholder.com/800x200?text=Reinforcement+Learning)

# 人工智能导论 - (七)强化学习

理解强化学习原理。

---


### 7.1 Q-Learning

```python
import numpy as np

class QLearning:
    """Q-Learning算法"""
    def __init__(self, n_states, n_actions, learning_rate=0.1, gamma=0.9, epsilon=0.1):
        self.q_table = np.zeros((n_states, n_actions))
        self.lr = learning_rate
        self.gamma = gamma
        self.epsilon = epsilon
    
    def choose_action(self, state):
        """ε-greedy策略选择动作"""
        if np.random.random() < self.epsilon:
            # 探索：随机选择
            return np.random.randint(self.q_table.shape[1])
        else:
            # 利用：选择最优动作
            return np.argmax(self.q_table[state])
    
    def update(self, state, action, reward, next_state):
        """Q值更新"""
        current_q = self.q_table[state, action]
        max_next_q = np.max(self.q_table[next_state])
        
        # Q-Learning更新公式
        new_q = current_q + self.lr * (reward + self.gamma * max_next_q - current_q)
        self.q_table[state, action] = new_q

# 示例：迷宫问题
class SimpleMaze:
    """简单迷宫环境"""
    def __init__(self, size=5):
        self.size = size
        self.n_states = size * size
        self.n_actions = 4  # 上下左右
        self.goal = size * size - 1
        self.reset()
    
    def reset(self):
        """重置环境"""
        self.state = 0
        return self.state
    
    def step(self, action):
        """执行动作"""
        row, col = divmod(self.state, self.size)
        
        # 上下左右
        if action == 0 and row > 0:  # 上
            row -= 1
        elif action == 1 and row < self.size - 1:  # 下
            row += 1
        elif action == 2 and col > 0:  # 左
            col -= 1
        elif action == 3 and col < self.size - 1:  # 右
            col += 1
        
        self.state = row * self.size + col
        
        # 奖励
        if self.state == self.goal:
            reward = 100
            done = True
        else:
            reward = -1
            done = False
        
        return self.state, reward, done

# 训练
env = SimpleMaze(size=5)
agent = QLearning(n_states=25, n_actions=4)

episodes = 500
for episode in range(episodes):
    state = env.reset()
    done = False
    
    while not done:
        action = agent.choose_action(state)
        next_state, reward, done = env.step(action)
        agent.update(state, action, reward, next_state)
        state = next_state
    
    if episode % 100 == 0:
        print(f"Episode {episode} completed")

print("Q表前5行:")
print(agent.q_table[:5])
```

---

## 8. 实战项目