![(四)大数定律与中心极限定理](https://via.placeholder.com/800x200?text=Law+of+Large+Numbers)

# 概率论与数理统计 - (四)大数定律与中心极限定理

理解大数定律和中心极限定理。

---


### 4.1 大数定律

**弱大数定律（Khinchin）：**

$$
\lim_{n \to \infty} P\left( \left| \frac{1}{n} \sum_{i=1}^{n} X_i - \mu \right| > \epsilon \right) = 0
$$

**应用：蒙特卡洛积分**

```python
def monte_carlo_pi(n_samples=1000000):
    """
    用蒙特卡洛方法估计π
    基于大数定律
    """
    # 在正方形[-1,1]×[-1,1]中随机采样
    x = np.random.uniform(-1, 1, n_samples)
    y = np.random.uniform(-1, 1, n_samples)
    
    # 计算落在单位圆内的点
    inside_circle = (x**2 + y**2) <= 1
    
    # π估计 = 4 × (圆内点数 / 总点数)
    pi_estimate = 4 * np.sum(inside_circle) / n_samples
    
    # 计算标准误差
    p = np.sum(inside_circle) / n_samples
    std_error = 4 * np.sqrt(p * (1-p) / n_samples)
    
    print(f"样本数: {n_samples}")
    print(f"π估计值: {pi_estimate:.6f}")
    print(f"真实值: {np.pi:.6f}")
    print(f"误差: {abs(pi_estimate - np.pi):.6f}")
    print(f"标准误差: {std_error:.6f}")
    
    return pi_estimate

monte_carlo_pi()
```

### 4.2 中心极限定理

**独立同分布的随机变量 $X_1, X_2, \ldots, X_n$：**

$$
\frac{\sum_{i=1}^{n} X_i - n\mu}{\sqrt{n}\sigma} \xrightarrow{d} N(0, 1)
$$

**应用：算法性能分析**

```python
def clt_demonstration(dist='uniform', n_samples=1000, n_trials=10000):
    """
    演示中心极限定理
    """
    sample_means = []
    
    for _ in range(n_trials):
        if dist == 'uniform':
            samples = np.random.uniform(0, 1, n_samples)
        elif dist == 'exponential':
            samples = np.random.exponential(1, n_samples)
        elif dist == 'binomial':
            samples = np.random.binomial(10, 0.5, n_samples)
        
        sample_means.append(np.mean(samples))
    
    sample_means = np.array(sample_means)
    
    # 理论值
    if dist == 'uniform':
        mu, sigma = 0.5, 1/np.sqrt(12)
    elif dist == 'exponential':
        mu, sigma = 1, 1
    elif dist == 'binomial':
        mu, sigma = 5, np.sqrt(2.5)
    
    theoretical_mean = mu
    theoretical_std = sigma / np.sqrt(n_samples)
    
    # 可视化
    plt.figure(figsize=(12, 5))
    
    plt.subplot(1, 2, 1)
    plt.hist(sample_means, bins=50, density=True, alpha=0.7, label='样本均值分布')
    x = np.linspace(sample_means.min(), sample_means.max(), 100)
    plt.plot(x, stats.norm.pdf(x, theoretical_mean, theoretical_std), 
             'r-', linewidth=2, label='理论正态分布')
    plt.xlabel('样本均值')
    plt.ylabel('密度')
    plt.title(f'中心极限定理 ({dist}分布, n={n_samples})')
    plt.legend()
    plt.grid()
    
    plt.subplot(1, 2, 2)
    stats.probplot(sample_means, dist="norm", plot=plt)
    plt.title('Q-Q图（正态性检验）')
    plt.grid()
    
    plt.tight_layout()
    plt.show()
    
    print(f"样本均值的均值: {np.mean(sample_means):.6f} (理论: {theoretical_mean:.6f})")
    print(f"样本均值的标准差: {np.std(sample_means):.6f} (理论: {theoretical_std:.6f})")

clt_demonstration('exponential', n_samples=100)
```

---

## 5. 参数估计