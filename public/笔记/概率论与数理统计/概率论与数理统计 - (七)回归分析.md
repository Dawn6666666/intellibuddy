![(七)回归分析](https://via.placeholder.com/800x200?text=Regression+Analysis)

# 概率论与数理统计 - (七)回归分析

学习线性回归和相关分析。

---


### 7.1 简单线性回归

**模型：**

$$
Y = \beta_0 + \beta_1 X + \epsilon
$$

**最小二乘估计：**

$$
\hat{\beta}_1 = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sum (x_i - \bar{x})^2}
$$

$$
\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}
$$

```python
def simple_linear_regression(X, y):
    """
    简单线性回归
    """
    n = len(X)
    x_mean = np.mean(X)
    y_mean = np.mean(y)
    
    # 计算系数
    beta_1 = np.sum((X - x_mean) * (y - y_mean)) / np.sum((X - x_mean)**2)
    beta_0 = y_mean - beta_1 * x_mean
    
    # 预测
    y_pred = beta_0 + beta_1 * X
    
    # R²
    ss_total = np.sum((y - y_mean)**2)
    ss_residual = np.sum((y - y_pred)**2)
    r_squared = 1 - ss_residual / ss_total
    
    print(f"回归方程: y = {beta_0:.4f} + {beta_1:.4f}x")
    print(f"R² = {r_squared:.4f}")
    
    # 可视化
    plt.figure(figsize=(10, 6))
    plt.scatter(X, y, alpha=0.6, label='数据点')
    plt.plot(X, y_pred, 'r-', linewidth=2, label='回归线')
    plt.xlabel('X')
    plt.ylabel('Y')
    plt.title('简单线性回归')
    plt.legend()
    plt.grid()
    plt.show()
    
    return beta_0, beta_1

# 示例
np.random.seed(42)
X = np.linspace(0, 10, 100)
y = 2 + 3*X + np.random.normal(0, 2, 100)

simple_linear_regression(X, y)
```

---

## 8. 典型例题详解