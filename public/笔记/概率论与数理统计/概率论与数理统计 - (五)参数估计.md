![(五)参数估计](https://via.placeholder.com/800x200?text=Parameter+Estimation)

# 概率论与数理统计 - (五)参数估计

学习点估计和区间估计方法。

---


### 5.1 点估计

**矩估计法：**用样本矩估计总体矩

**最大似然估计（MLE）：**

$$
\hat{\theta}_{MLE} = \arg\max_{\theta} \prod_{i=1}^{n} f(x_i; \theta)
$$

对数似然：

$$
\ell(\theta) = \sum_{i=1}^{n} \log f(x_i; \theta)
$$

**示例：正态分布参数估计**

```python
def mle_normal_distribution(data):
    """
    正态分布的最大似然估计
    """
    # MLE估计
    mu_mle = np.mean(data)
    sigma2_mle = np.var(data, ddof=0)  # 总体方差
    
    # 无偏估计
    mu_unbiased = np.mean(data)
    sigma2_unbiased = np.var(data, ddof=1)  # 样本方差
    
    print("=== 正态分布参数估计 ===")
    print(f"MLE估计: μ = {mu_mle:.4f}, σ² = {sigma2_mle:.4f}")
    print(f"无偏估计: μ = {mu_unbiased:.4f}, σ² = {sigma2_unbiased:.4f}")
    
    # 可视化
    plt.figure(figsize=(10, 6))
    plt.hist(data, bins=30, density=True, alpha=0.7, label='数据直方图')
    
    x = np.linspace(data.min(), data.max(), 100)
    plt.plot(x, stats.norm.pdf(x, mu_mle, np.sqrt(sigma2_mle)), 
             'r-', linewidth=2, label='MLE拟合')
    
    plt.xlabel('x')
    plt.ylabel('密度')
    plt.title('正态分布参数估计')
    plt.legend()
    plt.grid()
    plt.show()

# 测试
true_mu, true_sigma = 5, 2
data = np.random.normal(true_mu, true_sigma, 1000)
mle_normal_distribution(data)
```

### 5.2 区间估计

**置信区间（Confidence Interval）：**

正态分布均值的95%置信区间：

$$
\left[ \bar{X} - 1.96 \frac{\sigma}{\sqrt{n}}, \bar{X} + 1.96 \frac{\sigma}{\sqrt{n}} \right]
$$

```python
def confidence_interval(data, confidence=0.95):
    """
    计算均值的置信区间
    """
    n = len(data)
    mean = np.mean(data)
    std_err = stats.sem(data)  # 标准误差
    
    # t分布临界值（小样本）
    t_critical = stats.t.ppf((1 + confidence) / 2, n - 1)
    
    margin_of_error = t_critical * std_err
    ci_lower = mean - margin_of_error
    ci_upper = mean + margin_of_error
    
    print(f"{confidence*100}% 置信区间: [{ci_lower:.4f}, {ci_upper:.4f}]")
    print(f"点估计: {mean:.4f} ± {margin_of_error:.4f}")
    
    return ci_lower, ci_upper

data = np.random.normal(10, 2, 50)
confidence_interval(data)
```

---

## 6. 假设检验