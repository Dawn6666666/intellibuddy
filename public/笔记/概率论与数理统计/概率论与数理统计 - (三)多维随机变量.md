![(三)多维随机变量](https://via.placeholder.com/800x200?text=Multivariate+Distribution)

# 概率论与数理统计 - (三)多维随机变量

学习多维随机变量及其分布。

---


### 3.1 联合分布与边缘分布

**联合概率密度：**

$$
P(a < X \leq b, c < Y \leq d) = \int_a^b \int_c^d f(x, y) \, dy \, dx
$$

**边缘分布：**

$$
f_X(x) = \int_{-\infty}^{\infty} f(x, y) \, dy
$$

### 3.2 协方差与相关系数

**协方差：**

$$
\text{Cov}(X, Y) = E[(X - E[X])(Y - E[Y])] = E[XY] - E[X]E[Y]
$$

**相关系数：**

$$
\rho_{XY} = \frac{\text{Cov}(X, Y)}{\sqrt{\text{Var}(X) \text{Var}(Y)}}
$$

$-1 \leq \rho \leq 1$

**应用：特征相关性分析**

```python
def feature_correlation_analysis(X):
    """
    特征相关性分析
    X: 特征矩阵 (n_samples, n_features)
    """
    import seaborn as sns
    
    # 计算相关系数矩阵
    corr_matrix = np.corrcoef(X.T)
    
    # 可视化
    plt.figure(figsize=(10, 8))
    sns.heatmap(corr_matrix, annot=True, fmt='.2f', cmap='coolwarm', 
                square=True, cbar_kws={'label': '相关系数'})
    plt.title('特征相关性矩阵')
    plt.show()
    
    # 找出高度相关的特征对
    threshold = 0.8
    high_corr_pairs = []
    
    for i in range(len(corr_matrix)):
        for j in range(i+1, len(corr_matrix)):
            if abs(corr_matrix[i, j]) > threshold:
                high_corr_pairs.append((i, j, corr_matrix[i, j]))
    
    print("高度相关的特征对:")
    for i, j, corr in high_corr_pairs:
        print(f"特征{i} - 特征{j}: {corr:.3f}")
    
    return corr_matrix

# 示例数据
np.random.seed(42)
n_samples = 100
X = np.random.randn(n_samples, 5)
X[:, 1] = X[:, 0] + np.random.randn(n_samples) * 0.3  # 特征1与特征0高度相关

corr_matrix = feature_correlation_analysis(X)
```

---

## 4. 大数定律与中心极限定理