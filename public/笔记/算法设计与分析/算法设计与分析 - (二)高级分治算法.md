# 算法设计与分析 - (二)高级分治算法

掌握高级分治策略。

---

## 2. 高级分治算法

### 2.1 快速傅里叶变换（FFT）

**问题：**多项式乘法

$$
C(x) = A(x) \cdot B(x)
$$

**朴素算法：**$O(n^2)$

**FFT算法：**$O(n \log n)$

```python
import numpy as np

def fft(a):
    """
    快速傅里叶变换
    Cooley-Tukey算法
    """
    n = len(a)
    if n == 1:
        return a
    
    # 分治
    even = fft(a[::2])
    odd = fft(a[1::2])
    
    # 合并
    T = [np.exp(-2j * np.pi * k / n) * odd[k] for k in range(n // 2)]
    return [even[k] + T[k] for k in range(n // 2)] + \
           [even[k] - T[k] for k in range(n // 2)]

def poly_multiply_fft(A, B):
    """FFT多项式乘法"""
    n = 1
    while n < len(A) + len(B):
        n <<= 1
    
    # 补零到2的幂次
    A_padded = A + [0] * (n - len(A))
    B_padded = B + [0] * (n - len(B))
    
    # FFT变换
    A_fft = fft(A_padded)
    B_fft = fft(B_padded)
    
    # 点值乘法
    C_fft = [A_fft[i] * B_fft[i] for i in range(n)]
    
    # 逆FFT
    C = fft(C_fft)
    C = [c / n for c in C]  # 归一化
    
    return [int(round(c.real)) for c in C[:len(A) + len(B) - 1]]

# 示例
A = [1, 2, 3]  # 1 + 2x + 3x²
B = [4, 5, 6]  # 4 + 5x + 6x²

C = poly_multiply_fft(A, B)
print(f"结果: {C}")  # [4, 13, 28, 27, 18]
```

### 2.2 Strassen矩阵乘法

**标准算法：**$O(n^3)$

**Strassen算法：**$O(n^{2.807})$

```python
def strassen(A, B):
    """
    Strassen矩阵乘法
    """
    n = len(A)
    
    # 基础情况
    if n == 1:
        return [[A[0][0] * B[0][0]]]
    
    # 分块
    mid = n // 2
    A11 = [row[:mid] for row in A[:mid]]
    A12 = [row[mid:] for row in A[:mid]]
    A21 = [row[:mid] for row in A[mid:]]
    A22 = [row[mid:] for row in A[mid:]]
    
    B11 = [row[:mid] for row in B[:mid]]
    B12 = [row[mid:] for row in B[:mid]]
    B21 = [row[:mid] for row in B[mid:]]
    B22 = [row[mid:] for row in B[mid:]]
    
    # 7次乘法
    def add(X, Y):
        return [[X[i][j] + Y[i][j] for j in range(len(X[0]))] for i in range(len(X))]
    
    def sub(X, Y):
        return [[X[i][j] - Y[i][j] for j in range(len(X[0]))] for i in range(len(X))]
    
    M1 = strassen(add(A11, A22), add(B11, B22))
    M2 = strassen(add(A21, A22), B11)
    M3 = strassen(A11, sub(B12, B22))
    M4 = strassen(A22, sub(B21, B11))
    M5 = strassen(add(A11, A12), B22)
    M6 = strassen(sub(A21, A11), add(B11, B12))
    M7 = strassen(sub(A12, A22), add(B21, B22))
    
    C11 = add(sub(add(M1, M4), M5), M7)
    C12 = add(M3, M5)
    C21 = add(M2, M4)
    C22 = add(sub(add(M1, M3), M2), M6)
    
    # 合并
    C = [[0] * n for _ in range(n)]
    for i in range(mid):
        for j in range(mid):
            C[i][j] = C11[i][j]
            C[i][j+mid] = C12[i][j]
            C[i+mid][j] = C21[i][j]
            C[i+mid][j+mid] = C22[i][j]
    
    return C
```

---

**本章完**
