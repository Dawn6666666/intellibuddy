# 计算机导论 - (二)计算机硬件系统

学习计算机硬件的组成和工作原理。

---


### 2.1 冯·诺依曼体系结构

**核心思想：**
1. 计算机由五大部件组成
2. 程序和数据存储在同一存储器中（存储程序思想）
3. 程序由指令序列组成
4. 指令按顺序执行（可改变执行顺序）
5. 指令和数据都以二进制形式表示

#### 存储程序思想

**革命性意义：**
- 程序和数据统一存储在内存中
- 程序可以像数据一样被读取和修改
- 实现了计算机的通用性和可编程性

**示例理解：**
```
传统计算器：固定功能，无法改变计算逻辑
冯·诺依曼计算机：可以通过改变程序来改变功能
```

**实际应用：**
- 同一台计算机既可以运行Word，也可以运行游戏
- 只需加载不同的程序到内存即可切换功能
- 软件定义功能，硬件提供通用能力

#### 五大部件详解

**五大部件：**

```
┌─────────────────────────────────┐
│         输入设备（Input）         │
│    键盘、鼠标、麦克风、摄像头      │
└──────────────┬──────────────────┘
               ↓
┌──────────────────────────────────┐
│      存储器（Memory）              │
│    RAM、ROM、缓存                 │
│    - 程序                         │
│    - 数据                         │
└──────┬───────────────────┬───────┘
       ↓                   ↓
┌──────────────┐    ┌─────────────┐
│  运算器（ALU） │←→│  控制器（CU） │
└──────────────┘    └─────────────┘
       ↓
┌─────────────────────────────────┐
│        输出设备（Output）          │
└─────────────────────────────────┘
```

### 2.2 中央处理器（CPU）

**组成部分：**

1. **运算器（ALU - Arithmetic Logic Unit）**
   - 算术运算（加减乘除）
   - 逻辑运算（与或非）
   - 移位操作

2. **控制器（CU - Control Unit）**
   - 指令译码
   - 控制信号生成
   - 程序计数器（PC）
   - 指令寄存器（IR）

3. **寄存器组**
   - 通用寄存器
   - 程序计数器（PC）
   - 状态寄存器

**CPU主要性能指标：**

| 指标 | 说明 | 单位 |
|------|------|------|
| 主频（Clock Speed） | 时钟频率 | GHz |
| 核心数（Cores） | 处理器核心数量 | 个 |
| 缓存（Cache） | 高速缓存大小 | MB |
| 制程（Process） | 芯片制造工艺 | nm |
| 指令集（ISA） | 支持的指令集架构 | x86, ARM |

**经典CPU：**
- Intel Core 系列（桌面）
- AMD Ryzen 系列（桌面）
- ARM Cortex 系列（移动）
- Apple M 系列（ARM架构）

#### CPU工作原理

**指令执行周期（Instruction Cycle）：**

```
1. 取指（Fetch）
   ↓
2. 译码（Decode）
   ↓
3. 执行（Execute）
   ↓
4. 访存（Memory）
   ↓
5. 写回（Write Back）
```

**流水线技术（Pipeline）：**

多条指令同时在不同阶段执行，提高效率。

```
时钟周期：  1    2    3    4    5    6
指令1：    取指  译码  执行  访存  写回
指令2：         取指  译码  执行  访存  写回
指令3：              取指  译码  执行  访存
```

**超线程技术（Hyper-Threading）：**
- 一个物理核心虚拟成两个逻辑核心
- 提高资源利用率
- 性能提升约20-30%

**多核处理器：**

| 核心数 | 应用场景 | 示例产品 |
|--------|----------|----------|
| 2核 | 轻度办公 | Intel i3 |
| 4核 | 日常使用 | Intel i5 |
| 6-8核 | 游戏/创作 | Intel i7, AMD R7 |
| 12核以上 | 专业工作站 | AMD Threadripper |
| 64核以上 | 服务器 | AMD EPYC |

### 2.3 存储系统

#### 存储器层次结构

```
速度快 ↑          容量小 ↑         价格高 ↑
────────────────────────────────────────
寄存器（Register）         ～1KB
    ↓
L1 缓存（Cache）           ～256KB
    ↓
L2 缓存                    ～1-8MB
    ↓
L3 缓存                    ～8-64MB
    ↓
内存（RAM）                 ～8-32GB
    ↓
固态硬盘（SSD）            ～256GB-2TB
    ↓
机械硬盘（HDD）            ～1TB-20TB
────────────────────────────────────────
速度慢 ↓          容量大 ↓         价格低 ↓
```

#### 内存（RAM）

**RAM vs ROM：**

| 特性 | RAM | ROM |
|------|-----|-----|
| 全称 | Random Access Memory | Read-Only Memory |
| 易失性 | 断电丢失 | 断电保存 |
| 读写 | 可读写 | 只读（或不易写） |
| 速度 | 快 | 较慢 |
| 用途 | 程序运行 | BIOS、固件 |

**RAM类型：**
- **DRAM**（动态RAM）：需要定时刷新，常用于主内存
- **SRAM**（静态RAM）：不需刷新，速度快，用于缓存

#### 外部存储器

| 类型 | 原理 | 速度 | 容量 | 价格 |
|------|------|------|------|------|
| HDD | 磁盘 | 慢 | 大 | 低 |
| SSD（SATA） | 闪存 | 中 | 中 | 中 |
| SSD（NVMe） | 闪存+PCIe | 快 | 中 | 高 |
| 光盘 | 激光 | 慢 | 小 | 低 |
| U盘 | 闪存 | 中 | 小 | 低 |

#### 缓存工作原理

**局部性原理：**

1. **时间局部性**：最近访问的数据很可能再次被访问
2. **空间局部性**：访问某数据后，其附近的数据也可能被访问

**缓存映射方式：**

| 映射方式 | 特点 | 命中率 | 硬件成本 |
|----------|------|--------|----------|
| 直接映射 | 每个主存块对应唯一缓存位置 | 低 | 低 |
| 全相联映射 | 主存块可放任意缓存位置 | 高 | 高 |
| 组相联映射 | 折中方案 | 中 | 中 |

**缓存命中率计算：**

$$
\text{命中率} = \frac{\text{缓存命中次数}}{\text{总访问次数}} \times 100\%
$$

**示例：**
访问100次内存，90次在缓存中找到数据，命中率 = 90/100 = 90%

#### 虚拟内存

**概念**：用硬盘空间扩展内存。

**分页机制：**
- 将内存和硬盘分成固定大小的页（Page）
- 页面大小通常为 4KB 或 8KB
- 使用页表（Page Table）管理映射

**页面置换算法：**

| 算法 | 策略 | 优点 | 缺点 |
|------|------|------|------|
| FIFO | 先进先出 | 简单 | 可能淘汰常用页 |
| LRU | 最近最少使用 | 命中率高 | 实现复杂 |
| LFU | 最不常用 | 考虑使用频率 | 开销大 |
| Clock | 时钟算法 | 折中 | 近似LRU |

### 2.4 总线系统

**总线定义**：连接计算机各部件的公共通信通道。

#### 总线分类

**按功能分类：**

```
数据总线（Data Bus）
    ↓ 传输数据
地址总线（Address Bus）
    ↓ 传输地址
控制总线（Control Bus）
    ↓ 传输控制信号
```

**按位置分类：**

| 总线类型 | 连接部件 | 示例 |
|----------|----------|------|
| 内部总线 | CPU内部 | ALU与寄存器 |
| 系统总线 | CPU与主板 | 前端总线（FSB） |
| I/O总线 | 外部设备 | USB、PCIe |

**常见总线标准：**

| 标准 | 类型 | 速度 | 应用 |
|------|------|------|------|
| PCIe 4.0 | 内部 | 16 GB/s | 显卡、SSD |
| USB 3.2 | 外部 | 2.5 GB/s | 外设 |
| SATA III | 存储 | 600 MB/s | 硬盘 |
| Thunderbolt 4 | 通用 | 40 Gb/s | 高速传输 |

#### 总线性能指标

1. **总线宽度**：一次传输的数据位数（32位、64位）
2. **总线频率**：工作频率（MHz、GHz）
3. **总线带宽**：数据传输速率

**带宽计算公式：**

$$
\text{带宽} = \text{总线宽度} \times \text{总线频率}
$$

**示例：**
64位总线，频率133MHz，带宽 = 64 × 133M = 8.512 Gb/s ≈ 1 GB/s

### 2.5 输入输出设备

#### 输入设备

| 设备 | 功能 | 示例 |
|------|------|------|
| 键盘 | 文字输入 | 机械键盘、薄膜键盘 |
| 鼠标 | 指针控制 | 光学鼠标、激光鼠标 |
| 触摸屏 | 触控输入 | 电容屏、电阻屏 |
| 扫描仪 | 图像输入 | 平板扫描仪 |
| 摄像头 | 视频输入 | 网络摄像头 |
| 麦克风 | 音频输入 | 驻极体话筒 |

#### 输出设备

| 设备 | 功能 | 技术 |
|------|------|------|
| 显示器 | 图像显示 | LCD、OLED、LED |
| 打印机 | 纸质输出 | 喷墨、激光 |
| 音箱 | 音频输出 | 模拟/数字音箱 |
| 投影仪 | 大屏显示 | DLP、LCD |

---

## 3. 计算机软件系统