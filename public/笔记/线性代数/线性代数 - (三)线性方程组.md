# 线性代数 - (三)线性方程组

学习线性方程组的解法。

---

## 3.1 高斯消元法

**步骤：**
1. 化为行阶梯形（前向消元）
2. 化为行最简形（后向消元）
3. 写出解

**示例：**

$$
\begin{cases}
x + 2y + z = 4 \\
2x + 5y + 4z = 11 \\
x + 3y + 6z = 11
\end{cases}
$$

增广矩阵：

$$
\left[\begin{array}{ccc|c}
1 & 2 & 1 & 4 \\
2 & 5 & 4 & 11 \\
1 & 3 & 6 & 11
\end{array}\right]
$$

行变换：

$$
\left[\begin{array}{ccc|c}
1 & 2 & 1 & 4 \\
0 & 1 & 2 & 3 \\
0 & 0 & 1 & 1
\end{array}\right]
$$

解：$z = 1, y = 1, x = 1$

**Python实现：**

```python
def gauss_elimination(A, b):
    """高斯消元法"""
    n = len(b)
    # 构造增广矩阵
    M = np.hstack([A.astype(float), b.reshape(-1, 1)])
    
    # 前向消元
    for i in range(n):
        # 选主元（避免除以0）
        max_row = i + np.argmax(abs(M[i:, i]))
        M[[i, max_row]] = M[[max_row, i]]
        
        # 消元
        for j in range(i + 1, n):
            M[j] -= M[j, i] / M[i, i] * M[i]
    
    # 回代
    x = np.zeros(n)
    for i in range(n - 1, -1, -1):
        x[i] = (M[i, -1] - np.dot(M[i, i+1:n], x[i+1:])) / M[i, i]
    
    return x

A = np.array([
    [1, 2, 1],
    [2, 5, 4],
    [1, 3, 6]
], dtype=float)
b = np.array([4, 11, 11], dtype=float)

x = gauss_elimination(A, b)
print(f"解: {x}")  # [1. 1. 1.]
```

### 3.2 解的结构

对于 $Ax = b$：

| 情况 | 条件 | 解的个数 |
|------|------|----------|
| 唯一解 | $\text{rank}(A) = \text{rank}(A|b) = n$ | 1 |
| 无穷解 | $\text{rank}(A) = \text{rank}(A|b) < n$ | $\infty$ |
| 无解 | $\text{rank}(A) < \text{rank}(A|b)$ | 0 |

**齐次方程组** $Ax = 0$：

- 必有零解
- 非零解存在 $\Leftrightarrow$ $\text{rank}(A) < n$

### 3.3 最小二乘法

当方程组无精确解时，求最小二乘解：

$$
\min_{x} \|Ax - b\|^2
$$

**正规方程：**

$$
A^T A x = A^T b
$$

$$
x = (A^T A)^{-1} A^T b
$$

**应用：线性回归**

```python
def least_squares(X, y):
    """最小二乘法"""
    return np.linalg.inv(X.T @ X) @ X.T @ y

# 示例：拟合直线 y = ax + b
X = np.array([[1, 1], [1, 2], [1, 3], [1, 4]])  # [1, x]
y = np.array([2.1, 3.9, 6.1, 7.9])

params = least_squares(X, y)
print(f"a = {params[1]:.2f}, b = {params[0]:.2f}")  # a ≈ 2, b ≈ 0
```

---

**本章完**
