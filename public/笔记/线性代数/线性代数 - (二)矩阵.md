# 线性代数 - (二)矩阵

掌握矩阵的运算和性质。

---

## 2.1 矩阵的基本概念

**定义**：$m \times n$ 矩阵是 $m$ 行 $n$ 列的数表。

$$
A_{m \times n} = \begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
$$

**特殊矩阵：**

| 名称 | 定义 | 示例 |
|------|------|------|
| 零矩阵 | 所有元素为0 | $\begin{bmatrix} 0 & 0 \\ 0 & 0 \end{bmatrix}$ |
| 单位矩阵 | 对角线为1，其余为0 | $\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$ |
| 对角矩阵 | 非对角元素为0 | $\begin{bmatrix} 2 & 0 \\ 0 & 3 \end{bmatrix}$ |
| 对称矩阵 | $A^T = A$ | $\begin{bmatrix} 1 & 2 \\ 2 & 3 \end{bmatrix}$ |
| 反对称矩阵 | $A^T = -A$ | $\begin{bmatrix} 0 & 2 \\ -2 & 0 \end{bmatrix}$ |

### 2.2 矩阵运算

#### 矩阵加法

$$
(A + B)_{ij} = a_{ij} + b_{ij}
$$

**示例：**

$$
\begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix} + \begin{bmatrix} 5 & 6 \\ 7 & 8 \end{bmatrix} = \begin{bmatrix} 6 & 8 \\ 10 & 12 \end{bmatrix}
$$

#### 数乘

$$
(kA)_{ij} = k \cdot a_{ij}
$$

#### 矩阵乘法

$$
(AB)_{ij} = \sum_{k=1}^{n} a_{ik} b_{kj}
$$

**注意**：$AB \neq BA$（不满足交换律）

**示例：**

$$
\begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix} \begin{bmatrix} 5 & 6 \\ 7 & 8 \end{bmatrix} = \begin{bmatrix} 1 \cdot 5 + 2 \cdot 7 & 1 \cdot 6 + 2 \cdot 8 \\ 3 \cdot 5 + 4 \cdot 7 & 3 \cdot 6 + 4 \cdot 8 \end{bmatrix} = \begin{bmatrix} 19 & 22 \\ 43 & 50 \end{bmatrix}
$$

**NumPy实现：**

```python
import numpy as np

A = np.array([[1, 2], [3, 4]])
B = np.array([[5, 6], [7, 8]])

# 矩阵乘法
C = A @ B  # 或 np.dot(A, B)
print(C)
# [[19 22]
#  [43 50]]

# 逐元素乘法
D = A * B  # 注意：不是矩阵乘法
print(D)
# [[ 5 12]
#  [21 32]]
```

#### 转置

$$
(A^T)_{ij} = a_{ji}
$$

**性质：**

$$
(A^T)^T = A
$$

$$
(AB)^T = B^T A^T
$$

### 2.3 矩阵的逆

**定义**：若 $AB = BA = I$，则 $B$ 是 $A$ 的逆矩阵，记作 $A^{-1}$。

**可逆条件**：$\det(A) \neq 0$

**二阶矩阵求逆公式：**

$$
\begin{bmatrix} a & b \\ c & d \end{bmatrix}^{-1} = \frac{1}{ad-bc} \begin{bmatrix} d & -b \\ -c & a \end{bmatrix}
$$

**示例：**

$$
A = \begin{bmatrix} 2 & 1 \\ 5 & 3 \end{bmatrix}
$$

$$
\det(A) = 2 \cdot 3 - 1 \cdot 5 = 1
$$

$$
A^{-1} = \frac{1}{1} \begin{bmatrix} 3 & -1 \\ -5 & 2 \end{bmatrix} = \begin{bmatrix} 3 & -1 \\ -5 & 2 \end{bmatrix}
$$

**NumPy实现：**

```python
A = np.array([[2, 1], [5, 3]])
A_inv = np.linalg.inv(A)
print(A_inv)
# [[ 3. -1.]
#  [-5.  2.]]

# 验证
print(A @ A_inv)  # 单位矩阵
```

### 2.4 矩阵的秩

**定义**：矩阵中非零子式的最高阶数。

**性质：**
- $\text{rank}(A) \leq \min(m, n)$
- $\text{rank}(A) = \text{rank}(A^T)$
- $\text{rank}(AB) \leq \min(\text{rank}(A), \text{rank}(B))$
- $\text{rank}(A + B) \leq \text{rank}(A) + \text{rank}(B)$

**计算方法**：化为行阶梯形，非零行数即为秩。

**示例：行阶梯化求秩**

$$
A = \begin{bmatrix}
1 & 2 & 3 \\
2 & 4 & 6 \\
1 & 1 & 2
\end{bmatrix}
$$

行变换：

$$
\begin{bmatrix}
1 & 2 & 3 \\
0 & 0 & 0 \\
0 & -1 & -1
\end{bmatrix}
\rightarrow
\begin{bmatrix}
1 & 2 & 3 \\
0 & -1 & -1 \\
0 & 0 & 0
\end{bmatrix}
$$

秩为 $2$（两个非零行）

**NumPy实现：**

```python
A = np.array([
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
])

rank = np.linalg.matrix_rank(A)
print(f"秩: {rank}")  # 2

# 行阶梯化（使用SymPy）
import sympy as sp

A_sym = sp.Matrix(A)
rref, pivot_cols = A_sym.rref()
print("行最简形:")
print(rref)
print(f"主元列: {pivot_cols}")
```

**秩的应用：判断线性相关性**

```python
def is_linearly_independent(vectors):
    """判断向量组是否线性无关"""
    A = np.array(vectors).T
    rank = np.linalg.matrix_rank(A)
    return rank == len(vectors)

v1 = [1, 2, 3]
v2 = [2, 4, 6]  # v2 = 2*v1
v3 = [1, 0, 1]

print(is_linearly_independent([v1, v2]))  # False（线性相关）
print(is_linearly_independent([v1, v3]))  # True（线性无关）
```

### 2.5 矩阵的分块

**定义**：将大矩阵分成小块。

$$
A = \begin{bmatrix}
A_{11} & A_{12} \\
A_{21} & A_{22}
\end{bmatrix}
$$

**分块乘法：**

$$
\begin{bmatrix}
A_{11} & A_{12} \\
A_{21} & A_{22}
\end{bmatrix}
\begin{bmatrix}
B_{11} & B_{12} \\
B_{21} & B_{22}
\end{bmatrix}
=
\begin{bmatrix}
A_{11}B_{11} + A_{12}B_{21} & A_{11}B_{12} + A_{12}B_{22} \\
A_{21}B_{11} + A_{22}B_{21} & A_{21}B_{12} + A_{22}B_{22}
\end{bmatrix}
$$

**应用：大矩阵乘法优化**

```python
def block_matrix_multiply(A, B, block_size=2):
    """分块矩阵乘法"""
    n = A.shape[0]
    C = np.zeros((n, n))
    
    # 分块
    for i in range(0, n, block_size):
        for j in range(0, n, block_size):
            for k in range(0, n, block_size):
                # 提取子块
                A_block = A[i:i+block_size, k:k+block_size]
                B_block = B[k:k+block_size, j:j+block_size]
                C[i:i+block_size, j:j+block_size] += A_block @ B_block
    
    return C

# 测试
A = np.random.rand(4, 4)
B = np.random.rand(4, 4)

C_block = block_matrix_multiply(A, B)
C_normal = A @ B

print(f"结果一致: {np.allclose(C_block, C_normal)}")
```

### 2.6 特殊矩阵类型

#### 正定矩阵

**定义**：对称矩阵 $A$，若对所有 $\mathbf{x} \neq \mathbf{0}$ 都有 $\mathbf{x}^T A \mathbf{x} > 0$

**判别条件：**
1. 所有特征值 $> 0$
2. 所有主子式 $> 0$
3. 可以写成 $A = B^T B$

```python
def is_positive_definite(A):
    """判断是否为正定矩阵"""
    # 方法1: 特征值判断
    eigenvalues = np.linalg.eigvals(A)
    return np.all(eigenvalues > 0)

# 示例
A_pd = np.array([[2, -1], [-1, 2]])  # 正定
A_not = np.array([[1, 2], [2, 1]])   # 不正定

print(f"A是正定的: {is_positive_definite(A_pd)}")  # True
print(f"A是正定的: {is_positive_definite(A_not)}")  # False
```

#### 幂等矩阵

**定义**：$A^2 = A$

**性质：**
- 特征值只能是 $0$ 或 $1$
- $I - A$ 也是幂等矩阵

```python
# 投影矩阵（幂等）
v = np.array([[1], [1], [1]])
P = v @ v.T / (v.T @ v)  # 投影到v方向

print(f"P^2 = P: {np.allclose(P @ P, P)}")  # True
```

#### 幂零矩阵

**定义**：$\exists k, A^k = 0$

```python
# 幂零矩阵示例
A = np.array([
    [0, 1, 0],
    [0, 0, 1],
    [0, 0, 0]
])

print(f"A^3 = \n{np.linalg.matrix_power(A, 3)}")  # 零矩阵
```

---

**本章完**
