# 线性代数 - (九)线性变换

理解线性变换及其矩阵表示。

---

## 9.1 线性变换的定义

**定义**：映射 $T: V \to W$，满足
1. $T(\mathbf{u} + \mathbf{v}) = T(\mathbf{u}) + T(\mathbf{v})$
2. $T(k\mathbf{v}) = kT(\mathbf{v})$

**矩阵表示**：

$$
T(\mathbf{x}) = A\mathbf{x}
$$

### 9.2 常见线性变换

#### 2D旋转

$$
R_\theta = \begin{bmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{bmatrix}
$$

#### 2D缩放

$$
S = \begin{bmatrix}
s_x & 0 \\
0 & s_y
\end{bmatrix}
$$

#### 2D剪切

$$
K_x = \begin{bmatrix}
1 & k \\
0 & 1
\end{bmatrix}
$$

**组合变换示例：**

```python
def geometric_transform(points, transforms):
    """几何变换"""
    # 组合所有变换
    M = np.eye(2)
    for T in transforms:
        M = T @ M
    
    # 应用变换
    return (M @ points.T).T

# 定义变换
rotate = np.array([
    [np.cos(np.pi/4), -np.sin(np.pi/4)],
    [np.sin(np.pi/4), np.cos(np.pi/4)]
])

scale = np.array([
    [2, 0],
    [0, 1]
])

# 正方形
square = np.array([
    [0, 0], [1, 0], [1, 1], [0, 1], [0, 0]
])

# 先旋转再缩放
result = geometric_transform(square, [scale, rotate])

plt.figure(figsize=(8, 4))
plt.subplot(121)
plt.plot(square[:, 0], square[:, 1], 'b-', linewidth=2)
plt.title('原图')
plt.axis('equal')
plt.grid(True)

plt.subplot(122)
plt.plot(result[:, 0], result[:, 1], 'r-', linewidth=2)
plt.title('变换后')
plt.axis('equal')
plt.grid(True)
plt.show()
```

### 9.3 核空间与值域

**核空间（Kernel）**：

$$
\text{Ker}(T) = \{\mathbf{v} \in V : T(\mathbf{v}) = \mathbf{0}\}
$$

**值域（Range）**：

$$
\text{Range}(T) = \{T(\mathbf{v}) : \mathbf{v} \in V\}
$$

**秩-零化度定理：**

$$
\dim(\text{Ker}(T)) + \dim(\text{Range}(T)) = \dim(V)
$$

```python
def find_kernel_and_range(A):
    """求核空间和值域"""
    # 核空间：Ax = 0的解空间
    _, s, Vt = np.linalg.svd(A)
    null_mask = s < 1e-10
    kernel_basis = Vt[null_mask]
    
    # 值域：列空间
    rank = np.linalg.matrix_rank(A)
    _, _, Vt = np.linalg.svd(A.T)
    range_basis = Vt[:rank]
    
    print(f"核空间维数: {len(kernel_basis)}")
    print(f"值域维数: {len(range_basis)}")
    print(f"验证秩-零化度定理: {len(kernel_basis)} + {len(range_basis)} = {A.shape[1]}")
    
    return kernel_basis, range_basis

# 示例
A = np.array([
    [1, 2, 3],
    [2, 4, 6]
], dtype=float)

kernel, range_basis = find_kernel_and_range(A)
```

---

**本章完**
