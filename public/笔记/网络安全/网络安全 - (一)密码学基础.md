# ç½‘ç»œå®‰å…¨ - (ä¸€)å¯†ç å­¦åŸºç¡€

å­¦ä¹ åŠ å¯†ç®—æ³•ä¸åº”ç”¨ã€‚

---

## 1. å¯†ç å­¦åŸºç¡€

### 1.1 å¯¹ç§°åŠ å¯†

```python
from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes
from Crypto.Util.Padding import pad, unpad
import base64

class AESCipher:
    def __init__(self, key=None):
        self.key = key or get_random_bytes(32)  # 256ä½å¯†é’¥
    
    def encrypt(self, plaintext):
        """AESåŠ å¯†"""
        cipher = AES.new(self.key, AES.MODE_CBC)
        
        # å¡«å……åˆ°16å­—èŠ‚çš„å€æ•°
        padded_text = pad(plaintext.encode(), AES.block_size)
        
        # åŠ å¯†
        ciphertext = cipher.encrypt(padded_text)
        
        # è¿”å›IV + å¯†æ–‡çš„Base64ç¼–ç 
        return base64.b64encode(cipher.iv + ciphertext).decode()
    
    def decrypt(self, encrypted_text):
        """AESè§£å¯†"""
        encrypted_data = base64.b64decode(encrypted_text)
        
        # æå–IVå’Œå¯†æ–‡
        iv = encrypted_data[:AES.block_size]
        ciphertext = encrypted_data[AES.block_size:]
        
        # è§£å¯†
        cipher = AES.new(self.key, AES.MODE_CBC, iv)
        padded_plaintext = cipher.decrypt(ciphertext)
        
        # å»é™¤å¡«å……
        plaintext = unpad(padded_plaintext, AES.block_size)
        
        return plaintext.decode()

# æµ‹è¯•AESåŠ å¯†
aes = AESCipher()
message = "è¿™æ˜¯ä¸€æ¡æœºå¯†ä¿¡æ¯"

encrypted = aes.encrypt(message)
print(f"ğŸ”’ åŠ å¯†: {encrypted}")

decrypted = aes.decrypt(encrypted)
print(f"ğŸ”“ è§£å¯†: {decrypted}")
```

### 1.2 éå¯¹ç§°åŠ å¯†ï¼ˆRSAï¼‰

```python
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from Crypto.Signature import pkcs1_15
from Crypto.Hash import SHA256
import base64

class RSACipher:
    def __init__(self, key_size=2048):
        self.key_pair = RSA.generate(key_size)
        self.public_key = self.key_pair.publickey()
    
    def get_public_key_pem(self):
        """è·å–å…¬é’¥PEMæ ¼å¼"""
        return self.public_key.export_key().decode()
    
    def get_private_key_pem(self):
        """è·å–ç§é’¥PEMæ ¼å¼"""
        return self.key_pair.export_key().decode()
    
    def encrypt(self, plaintext, public_key=None):
        """RSAåŠ å¯†ï¼ˆä½¿ç”¨å…¬é’¥ï¼‰"""
        key = public_key or self.public_key
        cipher = PKCS1_OAEP.new(key)
        
        # RSAåŠ å¯†æœ‰é•¿åº¦é™åˆ¶ï¼Œéœ€è¦åˆ†å—
        max_length = key.size_in_bytes() - 42  # OAEPå¡«å……å¼€é”€
        
        if len(plaintext.encode()) <= max_length:
            ciphertext = cipher.encrypt(plaintext.encode())
            return base64.b64encode(ciphertext).decode()
        else:
            raise ValueError("æ¶ˆæ¯å¤ªé•¿ï¼Œéœ€è¦åˆ†å—å¤„ç†")
    
    def decrypt(self, encrypted_text):
        """RSAè§£å¯†ï¼ˆä½¿ç”¨ç§é’¥ï¼‰"""
        cipher = PKCS1_OAEP.new(self.key_pair)
        ciphertext = base64.b64decode(encrypted_text)
        
        plaintext = cipher.decrypt(ciphertext)
        return plaintext.decode()
    
    def sign(self, message):
        """æ•°å­—ç­¾å"""
        hash_obj = SHA256.new(message.encode())
        signature = pkcs1_15.new(self.key_pair).sign(hash_obj)
        return base64.b64encode(signature).decode()
    
    def verify(self, message, signature, public_key=None):
        """éªŒè¯ç­¾å"""
        key = public_key or self.public_key
        hash_obj = SHA256.new(message.encode())
        signature_bytes = base64.b64decode(signature)
        
        try:
            pkcs1_15.new(key).verify(hash_obj, signature_bytes)
            return True
        except:
            return False

# æµ‹è¯•RSA
rsa = RSACipher()
message = "é‡è¦åˆåŒå†…å®¹"

# åŠ å¯†
encrypted = rsa.encrypt(message)
print(f"ğŸ”’ RSAåŠ å¯†: {encrypted[:50]}...")

# è§£å¯†
decrypted = rsa.decrypt(encrypted)
print(f"ğŸ”“ RSAè§£å¯†: {decrypted}")

# æ•°å­—ç­¾å
signature = rsa.sign(message)
print(f"âœï¸  æ•°å­—ç­¾å: {signature[:50]}...")

# éªŒè¯ç­¾å
is_valid = rsa.verify(message, signature)
print(f"âœ… ç­¾åéªŒè¯: {is_valid}")
```

### 1.3 å“ˆå¸Œå‡½æ•°ä¸æ¶ˆæ¯è®¤è¯

```python
import hashlib
import hmac
import secrets

class HashUtils:
    @staticmethod
    def sha256(data):
        """SHA-256å“ˆå¸Œ"""
        return hashlib.sha256(data.encode()).hexdigest()
    
    @staticmethod
    def md5(data):
        """MD5å“ˆå¸Œï¼ˆä¸å®‰å…¨ï¼Œä»…ç”¨äºæ¼”ç¤ºï¼‰"""
        return hashlib.md5(data.encode()).hexdigest()
    
    @staticmethod
    def hmac_sha256(key, message):
        """HMAC-SHA256æ¶ˆæ¯è®¤è¯ç """
        return hmac.new(key.encode(), message.encode(), hashlib.sha256).hexdigest()
    
    @staticmethod
    def generate_salt(length=32):
        """ç”Ÿæˆéšæœºç›å€¼"""
        return secrets.token_hex(length)
    
    @staticmethod
    def hash_password(password, salt=None):
        """å®‰å…¨çš„å¯†ç å“ˆå¸Œ"""
        if salt is None:
            salt = HashUtils.generate_salt()
        
        # ä½¿ç”¨PBKDF2è¿›è¡Œå¯†é’¥æ‹‰ä¼¸
        import hashlib
        key = hashlib.pbkdf2_hmac('sha256', 
                                  password.encode(), 
                                  salt.encode(), 
                                  100000)  # 10ä¸‡æ¬¡è¿­ä»£
        
        return salt + key.hex()
    
    @staticmethod
    def verify_password(password, hashed):
        """éªŒè¯å¯†ç """
        salt = hashed[:64]  # å‰64ä¸ªå­—ç¬¦æ˜¯ç›å€¼
        key = hashed[64:]
        
        new_key = hashlib.pbkdf2_hmac('sha256',
                                      password.encode(),
                                      salt.encode(),
                                      100000)
        
        return key == new_key.hex()

# æµ‹è¯•å“ˆå¸Œå’ŒHMAC
data = "æ•æ„Ÿæ•°æ®"
key = "secret_key"

print(f"ğŸ“Š åŸå§‹æ•°æ®: {data}")
print(f"ğŸ”¢ SHA-256: {HashUtils.sha256(data)}")
print(f"ğŸ” HMAC-SHA256: {HashUtils.hmac_sha256(key, data)}")

# æµ‹è¯•å¯†ç å“ˆå¸Œ
password = "my_secure_password"
hashed = HashUtils.hash_password(password)
print(f"\nğŸ”’ å¯†ç å“ˆå¸Œ: {hashed}")

is_valid = HashUtils.verify_password(password, hashed)
print(f"âœ… å¯†ç éªŒè¯: {is_valid}")

is_invalid = HashUtils.verify_password("wrong_password", hashed)
print(f"âŒ é”™è¯¯å¯†ç : {is_invalid}")
```

---

**æœ¬ç« å®Œ**
